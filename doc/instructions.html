<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>CNN</title>
<link rel="stylesheet" href="https://stackedit.io/res-min/themes/base.css" />
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body><div class="container"><h1 id="vgg-convolutional-neural-netwroks-practrical">VGG Convolutional Neural Netwroks Practrical</h1>

<blockquote>
  <p>Andrea Vedaldi and Andrew Zisserman</p>
</blockquote>

<p>This is an <a href="http://www.robots.ox.ac.uk/~vgg">Oxford Visual Geometry Group</a> computer vision practical, authored by <a href="http://www.robots.ox.ac.uk/~vedaldi/">Andrea Vedaldi</a> and Andrew Zisserman (Release 2015a).</p>

<p>![cover][1]</p>

<p><em>Convolutional neural networks</em> are an important class of learnable representations applicable, among others, to numerous computer vision problems. Deep CNNs, in particular, hare composed of several layers of processing, each involving linear as well as non-linear operators, that are learned jointly, in an end-to-end manner, to solve a particular tasks. Such methods become the predominant for feature extraction from audiovisual and textual data.</p>

<p><div class="toc"><div class="toc">
<ul>
<li><a href="#vgg-convolutional-neural-netwroks-practrical">VGG Convolutional Neural Netwroks Practrical</a><ul>
<li><a href="#getting-started">Getting started</a></li>
<li><a href="#part1">Part 1: CNN building blocks</a><ul>
<li><a href="#part1-1">Part 1.1: linear convolution</a></li>
<li><a href="#part1-2">Part 1.2: non-linear gating</a></li>
<li><a href="#part1-3">Part 1.3: pooling</a></li>
<li><a href="#part1-4">Part 1.4: normalisation</a></li>
</ul>
</li>
<li><a href="#part-2-back-propagation-and-derivatives">Part 2: back-propagation and derivatives</a><ul>
<li><a href="#part-21-theory">Part 2.1: Theory</a></li>
<li><a href="#part-21-putting-it-to-the-practice">Part 2.1: Putting it to the practice</a></li>
</ul>
</li>
<li><a href="#part-3-a-simple-cnn">Part 3: a simple CNN</a></li>
<li><a href="#part-4">Part 4:</a></li>
</ul>
</li>
</ul>
</div>
</div>
</p>



<p><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-12184-Frame" style=""><nobr><span class="math" id="MathJax-Span-136360" style="width: 0.014em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(3.869em, 1000em, 4.167em, -0.446em); top: -4.018em; left: 0em;"><span class="mrow" id="MathJax-Span-136361"></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.111em; vertical-align: -0.056em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-12184">
   \newcommand{\bx}{\mathbf{x}}
   \newcommand{\by}{\mathbf{y}}
   \newcommand{\bz}{\mathbf{z}}
   \newcommand{\bw}{\mathbf{w}}
   \newcommand{\vc}{\operatorname{vec}}
</script></p>

<h2 id="getting-started">Getting started</h2>

<p>Read and understand the <a href="../overview/index.html#installation">requirements and installation instructions</a>. The download links for this practical are:</p>

<ul>
<li>Code and data: <a href="http://www.robots.ox.ac.uk/~vgg/share/practical-cnn-2015a.tar.gz">practical-cnn-2015a.tar.gz</a></li>
<li>Code only: <a href="http://www.robots.ox.ac.uk/~vgg/share/practical-cnn-2015a-code-only.tar.gz">practical-cnn-2015a-code-only.tar.gz</a></li>
<li>Data only: <a href="http://www.robots.ox.ac.uk/~vgg/share/practical-cnn-2015a-data-only.tar.gz">practical-cnn-2015a-data-only.tar.gz</a></li>
<li><a href="https://github.com/vedaldi/practical-object-cnn">Git repository</a> (for lab setters and developers)</li>
</ul>

<p>After the installation is complete, open and edit the script <code>exercise1.m</code> in the MATLAB editor. The script contains commented code and a description for all steps of this exercise, relative to <a href="#part1">Part I</a> of this document. You can cut and paste this code into the MATLAB window to run it, and will need to modify it as you go through the session. Other files <code>exercise2.m</code>, <code>exercise3.m</code>, and <code>exercise4.m</code> are given for <a href="#part2">Part II</a>, <a href="#part3">III</a>, and <a href="part4">IV</a>.</p>

<p>Each part contains several <strong>Questions</strong> (that require pen and paper) and <strong>Tasks</strong> (that require experimentation or coding) to be answered/completed before proceeding further in the practical.</p>

<h2 id="part1">Part 1: CNN building blocks</h2>



<h3 id="part1-1" class="1">Part 1.1: linear convolution</h3>

<p>A feed-forward neural network can be thought of as the composition of number of functions  <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-6767-Frame" style=""><nobr><span class="math" id="MathJax-Span-73077" style="width: 17.292em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.427em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.871em, -0.593em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-73078"><span class="mi" id="MathJax-Span-73079" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-73080" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-73081"><span class="mrow" id="MathJax-Span-73082"><span class="mi" id="MathJax-Span-73083" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-73084" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-73085" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-73086" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-73087" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-73088" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-73089" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-73090" style="font-family: STIXGeneral-Regular;">…</span><span class="msubsup" id="MathJax-Span-73091" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-73092" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mn" id="MathJax-Span-73093" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-73094" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-73095"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-73096" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mn" id="MathJax-Span-73097" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-73098" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-73099"><span class="mrow" id="MathJax-Span-73100"><span class="mi" id="MathJax-Span-73101" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-73102" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-73103" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.166em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73104"><span class="mrow" id="MathJax-Span-73105"><span class="mi" id="MathJax-Span-73106" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mn" id="MathJax-Span-73107" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-73108" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-73109" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-73110" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.166em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73111"><span class="mrow" id="MathJax-Span-73112"><span class="mi" id="MathJax-Span-73113" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mn" id="MathJax-Span-73114" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-73115" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-73116" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-73117" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-73118" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-73119" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.216em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73120"><span class="mrow" id="MathJax-Span-73121"><span class="mi" id="MathJax-Span-73122" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="texatom" id="MathJax-Span-73123"><span class="mrow" id="MathJax-Span-73124"><span class="mi" id="MathJax-Span-73125" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-73126" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-73127" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.142em; vertical-align: -0.327em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-6767">
f(\bx) = f_L(\dots f_2(f_1(\bx;\bw_1);\bw_2)\dots),\bw_{L}).
</script> <br>
Each function <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6768-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73128" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.405em, 1000em, 2.631em, -0.593em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-73129"><span class="msubsup" id="MathJax-Span-73130"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-73131" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-73132" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.151em; vertical-align: -0.336em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6768">f_l</script> takes as input a datum <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6769-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73133" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.539em, -0.434em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-73134"><span class="msubsup" id="MathJax-Span-73135"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73136"><span class="mrow" id="MathJax-Span-73137"><span class="mi" id="MathJax-Span-73138" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mi" id="MathJax-Span-73139" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.804em; vertical-align: -0.232em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6769">\bx_l</script> and a parameter vector <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6770-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73140" style="width: 1.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.539em, -0.423em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-73141"><span class="msubsup" id="MathJax-Span-73142"><span style="display: inline-block; position: relative; width: 1.017em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73143"><span class="mrow" id="MathJax-Span-73144"><span class="mi" id="MathJax-Span-73145" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mi" id="MathJax-Span-73146" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.804em; vertical-align: -0.232em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6770">\bw_l</script> and produces as output a datum <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6771-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73147" style="width: 1.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.637em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.56em, -0.434em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-73148"><span class="msubsup" id="MathJax-Span-73149"><span style="display: inline-block; position: relative; width: 1.613em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73150"><span class="mrow" id="MathJax-Span-73151"><span class="mi" id="MathJax-Span-73152" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="texatom" id="MathJax-Span-73153"><span class="mrow" id="MathJax-Span-73154"><span class="mi" id="MathJax-Span-73155" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-73156" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-73157" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.828em; vertical-align: -0.256em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6771">\bx_{l+1}</script>. While the type and sequence of functions is usually handcrafted, the paramters <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6772-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73158" style="width: 8.014em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.143em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.655em, 1000em, 2.806em, -0.423em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-73159"><span class="texatom" id="MathJax-Span-73160"><span class="mrow" id="MathJax-Span-73161"><span class="mi" id="MathJax-Span-73162" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-73163" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-73164" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">(</span><span class="msubsup" id="MathJax-Span-73165"><span style="display: inline-block; position: relative; width: 1.166em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73166"><span class="mrow" id="MathJax-Span-73167"><span class="mi" id="MathJax-Span-73168" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mn" id="MathJax-Span-73169" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-73170" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-73171" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-73172" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-73173" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.216em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73174"><span class="mrow" id="MathJax-Span-73175"><span class="mi" id="MathJax-Span-73176" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mi" id="MathJax-Span-73177" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-73178" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.066em; vertical-align: -0.254em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6772">\bw=(\bw_1,\dots,\bw_L)</script> are <em>learned from data</em> in order to solve a target problem, for example classifying images or sounds.</p>

<p>In a <em>convolutional neural network</em> data and functions have additional structure. The data <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6773-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73179" style="width: 4.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.919em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.785em, -0.434em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-73180"><span class="msubsup" id="MathJax-Span-73181"><span style="display: inline-block; position: relative; width: 0.918em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73182"><span class="mrow" id="MathJax-Span-73183"><span class="mi" id="MathJax-Span-73184" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mn" id="MathJax-Span-73185" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-73186" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-73187" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-73188" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-73189" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.918em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73190"><span class="mrow" id="MathJax-Span-73191"><span class="mi" id="MathJax-Span-73192" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mi" id="MathJax-Span-73193" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.803em; vertical-align: -0.231em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6773">\bx_1,\dots,\bx_n</script> are images, sounds, or more in general maps from a lattice<a href="#fn:lattice" id="fnref:lattice" title="See footnote" class="footnote">1</a> to one or more real numbers. In particular, since the rest of the practical will focus on computer vision applications, data will be 2D dimensional arrays of pixels. Formally, each <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6774-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73194" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.539em, -0.434em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-73195"><span class="msubsup" id="MathJax-Span-73196"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73197"><span class="mrow" id="MathJax-Span-73198"><span class="mi" id="MathJax-Span-73199" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mi" id="MathJax-Span-73200" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.804em; vertical-align: -0.232em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6774">\bx_i</script> will be a <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6775-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73201" style="width: 5.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.613em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.654em, -0.464em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-73202"><span class="mi" id="MathJax-Span-73203" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mo" id="MathJax-Span-73204" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-73205" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-73206" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-73207" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.084em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6775">M \times N \times K</script> real array of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6776-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73208" style="width: 3.069em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.728em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.654em, -0.464em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-73209"><span class="mi" id="MathJax-Span-73210" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mo" id="MathJax-Span-73211" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-73212" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.084em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6776">M \times N</script> pixels and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6777-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73213" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.439em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-73214"><span class="mi" id="MathJax-Span-73215" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6777">K</script> channels per pixels. Hence the first two dimension of the array span space, while the last one channels. Note that only the input <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6778-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73216" style="width: 3.069em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.728em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.779em, -0.434em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-73217"><span class="texatom" id="MathJax-Span-73218"><span class="mrow" id="MathJax-Span-73219"><span class="mi" id="MathJax-Span-73220" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-73221" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-73222" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.918em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73223"><span class="mrow" id="MathJax-Span-73224"><span class="mi" id="MathJax-Span-73225" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mn" id="MathJax-Span-73226" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.795em; vertical-align: -0.224em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6778">\bx=\bx_1</script> of the network is an actual image, while the remaining data are intermediate <em>feature maps</em>.</p>

<p>The second property of a CNN is that the functions <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6779-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73227" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.405em, 1000em, 2.631em, -0.593em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-73228"><span class="msubsup" id="MathJax-Span-73229"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-73230" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-73231" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.151em; vertical-align: -0.336em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6779">f_l</script> have a <em>convolutional structure</em>. This means that <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6780-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73232" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.405em, 1000em, 2.631em, -0.593em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-73233"><span class="msubsup" id="MathJax-Span-73234"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-73235" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-73236" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.151em; vertical-align: -0.336em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6780">f_l</script> applies to the input map <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6781-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73237" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.539em, -0.434em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-73238"><span class="msubsup" id="MathJax-Span-73239"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73240"><span class="mrow" id="MathJax-Span-73241"><span class="mi" id="MathJax-Span-73242" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mi" id="MathJax-Span-73243" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.804em; vertical-align: -0.232em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6781">\bx_l</script> an operator that is <em>local and translation invariant</em>. Examples of convolutional operators are applying a bank of linear filters to <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6782-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-73244" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.539em, -0.434em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-73245"><span class="msubsup" id="MathJax-Span-73246"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73247"><span class="mrow" id="MathJax-Span-73248"><span class="mi" id="MathJax-Span-73249" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mi" id="MathJax-Span-73250" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.804em; vertical-align: -0.232em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6782">\bx_l</script> or computing its element-wise square. </p>

<p>In this part we will familiarise ourselves with a number of such convolutional operators. The first one is the regular <em>linear convolution</em> by a filter bank. We will start by focusing our attention on a single function relation as follows: <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-6783-Frame" style=""><nobr><span class="math" id="MathJax-Span-73251" style="width: 17.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.972em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.367em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-73252"><span class="mi" id="MathJax-Span-73253" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-73254" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">:</span><span class="msubsup" id="MathJax-Span-73255" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.299em; height: 0px;"><span style="position: absolute; clip: rect(1.669em, 1000em, 2.629em, -0.376em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73256"><span class="mrow" id="MathJax-Span-73257"><span class="mi" id="MathJax-Span-73258" style="font-family: STIXGeneral-Regular;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.695em; left: 0.744em;"><span class="texatom" id="MathJax-Span-73259"><span class="mrow" id="MathJax-Span-73260"><span class="mi" id="MathJax-Span-73261" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-73262" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="mi" id="MathJax-Span-73263" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span class="mo" id="MathJax-Span-73264" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="mi" id="MathJax-Span-73265" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-73266" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="msubsup" id="MathJax-Span-73267" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 4.291em; height: 0px;"><span style="position: absolute; clip: rect(1.669em, 1000em, 2.629em, -0.376em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-73268"><span class="mrow" id="MathJax-Span-73269"><span class="mi" id="MathJax-Span-73270" style="font-family: STIXGeneral-Regular;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.695em; left: 0.744em;"><span class="texatom" id="MathJax-Span-73271"><span class="mrow" id="MathJax-Span-73272"><span class="msup" id="MathJax-Span-73273"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(1.671em, 1000em, 2.431em, -0.459em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-73274" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.501em; left: 0.703em;"><span class="mo" id="MathJax-Span-73275" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span><span class="mo" id="MathJax-Span-73276" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="msup" id="MathJax-Span-73277"><span style="display: inline-block; position: relative; width: 0.81em; height: 0px;"><span style="position: absolute; clip: rect(1.671em, 1000em, 2.441em, -0.461em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-73278" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.501em; left: 0.559em;"><span class="mo" id="MathJax-Span-73279" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span><span class="mo" id="MathJax-Span-73280" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="msup" id="MathJax-Span-73281"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.671em, 1000em, 2.431em, -0.441em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-73282" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.501em; left: 0.558em;"><span class="mo" id="MathJax-Span-73283" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-73284" style="font-family: STIXGeneral-Regular;">,</span><span class="mspace" id="MathJax-Span-73285" style="height: 0em; vertical-align: 0em; width: 2.25em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-73286" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-73287"><span class="mi" id="MathJax-Span-73288" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-73289" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">↦</span><span class="texatom" id="MathJax-Span-73290" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-73291"><span class="mi" id="MathJax-Span-73292" style="font-family: STIXGeneral; font-weight: bold;">y</span></span></span><span class="mo" id="MathJax-Span-73293" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.423em; vertical-align: -0.287em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-6783">
 f: \mathbb{R}^{M\times N\times K} \rightarrow \mathbb{R}^{M' \times N' \times K'},
 \qquad \bx \mapsto \by.
</script> <br>
Open the <code>example1.m</code> file, select the following part of the code, and execute it in MATLAB (right button &gt; <code>Evaluate selection</code> or <code>Shift+F7</code>).</p>



<pre class="prettyprint"><code class="language-matlab hljs "><span class="hljs-comment">% Read an example image</span>
x = imread(<span class="hljs-string">'peppers.png'</span>) ;

<span class="hljs-comment">% Convert to single format</span>
x = im2single(x) ;

<span class="hljs-comment">% Visualize the input x</span>
figure(<span class="hljs-number">1</span>) ; clf ; imagesc(x) </code></pre>

<p>This should display an image of bell peppers in Figure 1:</p>

<p>![bell][2]</p>

<p>Use MATLAB <code>size</code> command to obtain the size of the array <code>x</code>. Note that the array <code>x</code> is converted to <em>single precision</em> format. This is because the underlying MatConvNet assumes that data is in single precision.</p>

<blockquote>
  <p><strong>Question.</strong> The third dimension of <code>x</code> is 3. Why?</p>
</blockquote>

<p>Now we will create a bank 10 of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4331-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-53441" style="width: 4.236em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.643em, 1000em, 2.654em, -0.415em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-53442"><span class="mn" id="MathJax-Span-53443" style="font-family: STIXGeneral-Regular;">5</span><span class="mo" id="MathJax-Span-53444" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mn" id="MathJax-Span-53445" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">5</span><span class="mo" id="MathJax-Span-53446" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mn" id="MathJax-Span-53447" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">3</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.91em; vertical-align: -0.084em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4331">5 \times 5 \times 3</script> filters.</p>

<pre class="prettyprint"><code class="language-matlab hljs "><span class="hljs-comment">% Create a bank of linear filters</span>
w = <span class="hljs-built_in">randn</span>(<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">10</span>,<span class="hljs-string">'single'</span>) ;</code></pre>

<p>The filters are in single precision as well. Note that <code>w</code> has four dimensions, packing 10 filters. Note also that each filter is not flat, but rather a volume with three layers. The next step is applying the filter to the image. This uses the <code>vl_nnconv</code> function from MatConvNet:</p>



<pre class="prettyprint"><code class="language-matlab hljs "><span class="hljs-comment">% Apply the convolutional operator</span>
y = vl_nnconv(x, w, <span class="hljs-matrix">[]</span>) ;</code></pre>

<p><strong>Remark:</strong> You might have noticed that the third argument to the <code>vl_nnconv</code> function is the empty matrix <code>[]</code>. It can be otherwise used to pass a vector of bias terms to add to the output of each filter.</p>

<p>The variable <code>y</code> contains the output of the convolution. Note that the filters are three-dimensional, in the sense that it operates on a map <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6638-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72248" style="width: 0.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.496em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72249"><span class="texatom" id="MathJax-Span-72250"><span class="mrow" id="MathJax-Span-72251"><span class="mi" id="MathJax-Span-72252" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6638">\bx</script> with <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6639-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72253" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.439em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72254"><span class="mi" id="MathJax-Span-72255" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6639">K</script> channels. Furthermore, there are <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6640-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72256" style="width: 1.292em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.141em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.304em, 1000em, 2.381em, -0.439em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-72257"><span class="msup" id="MathJax-Span-72258"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.439em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-72259" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.662em; left: 0.811em;"><span class="mo" id="MathJax-Span-72260" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.984em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6640">K'</script> such filters, generating a <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6641-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72261" style="width: 1.292em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.141em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.304em, 1000em, 2.381em, -0.439em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-72262"><span class="msup" id="MathJax-Span-72263"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.439em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-72264" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.662em; left: 0.811em;"><span class="mo" id="MathJax-Span-72265" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.984em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6641">K'</script> dimensional map <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6642-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72266" style="width: 0.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.496em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.834em, -0.43em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72267"><span class="texatom" id="MathJax-Span-72268"><span class="mrow" id="MathJax-Span-72269"><span class="mi" id="MathJax-Span-72270" style="font-family: STIXGeneral; font-weight: bold;">y</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.857em; vertical-align: -0.285em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6642">\by</script> as follows <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-6643-Frame" style=""><nobr><span class="math" id="MathJax-Span-72271" style="width: 12.069em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.764em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.356em, 1000em, 4.025em, -0.47em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72272"><span class="msubsup" id="MathJax-Span-72273"><span style="display: inline-block; position: relative; width: 2.124em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.47em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-72274" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -3.777em; left: 0.446em;"><span class="texatom" id="MathJax-Span-72275"><span class="mrow" id="MathJax-Span-72276"><span class="msup" id="MathJax-Span-72277"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; clip: rect(1.67em, 1000em, 2.438em, -0.412em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-72278" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.502em; left: 0.198em;"><span class="mo" id="MathJax-Span-72279" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span><span class="msup" id="MathJax-Span-72280"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px;"><span style="position: absolute; clip: rect(1.672em, 1000em, 2.577em, -0.534em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-72281" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.5em; left: 0.249em;"><span class="mo" id="MathJax-Span-72282" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span><span class="msup" id="MathJax-Span-72283"><span style="display: inline-block; position: relative; width: 0.652em; height: 0px;"><span style="position: absolute; clip: rect(1.65em, 1000em, 2.438em, -0.437em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-72284" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.522em; left: 0.401em;"><span class="mo" id="MathJax-Span-72285" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span></span></span><span class="mo" id="MathJax-Span-72286" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-72287" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.29em; height: 0px;"><span style="position: absolute; clip: rect(1.753em, 1000em, 3.501em, -0.356em); top: -2.877em; left: 0em;"><span class="mo" id="MathJax-Span-72288" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.877em;"></span></span><span style="position: absolute; clip: rect(1.65em, 1000em, 2.677em, -0.412em); top: -1.132em; left: 0.273em;"><span class="texatom" id="MathJax-Span-72289"><span class="mrow" id="MathJax-Span-72290"><span class="mi" id="MathJax-Span-72291" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-72292" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-72293" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-72294" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.513em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.647em, -0.431em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-72295" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.694em;"><span class="texatom" id="MathJax-Span-72296"><span class="mrow" id="MathJax-Span-72297"><span class="mi" id="MathJax-Span-72298" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-72299" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-72300" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-72301"><span style="display: inline-block; position: relative; width: 4.338em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.64em, -0.473em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-72302" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.443em;"><span class="texatom" id="MathJax-Span-72303"><span class="mrow" id="MathJax-Span-72304"><span class="mi" id="MathJax-Span-72305" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-72306" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="msup" id="MathJax-Span-72307"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; clip: rect(1.67em, 1000em, 2.438em, -0.412em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-72308" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.502em; left: 0.198em;"><span class="mo" id="MathJax-Span-72309" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span><span class="mo" id="MathJax-Span-72310" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-72311" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-72312" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="msup" id="MathJax-Span-72313"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px;"><span style="position: absolute; clip: rect(1.672em, 1000em, 2.577em, -0.534em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-72314" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.5em; left: 0.249em;"><span class="mo" id="MathJax-Span-72315" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span><span class="mo" id="MathJax-Span-72316" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-72317" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-72318" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-72319"><span style="display: inline-block; position: relative; width: 0.652em; height: 0px;"><span style="position: absolute; clip: rect(1.65em, 1000em, 2.438em, -0.437em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-72320" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.522em; left: 0.401em;"><span class="mo" id="MathJax-Span-72321" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.767em; vertical-align: -1.619em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-6643">
y_{i'j'k'} = \sum_{ijk} w_{ijk} x_{i+i',j+j',k,k'}
</script></p>

<blockquote>
  <p><strong>Questions:</strong> Study carefully this expression and answer the following:</p>
  
  <ul>
  <li>Given that the input map <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6644-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72322" style="width: 0.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.496em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72323"><span class="texatom" id="MathJax-Span-72324"><span class="mrow" id="MathJax-Span-72325"><span class="mi" id="MathJax-Span-72326" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6644">\bx</script> has <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6645-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72327" style="width: 5.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.613em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.654em, -0.464em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72328"><span class="mi" id="MathJax-Span-72329" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mo" id="MathJax-Span-72330" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-72331" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-72332" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-72333" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.084em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6645">M \times N \times K</script> dimensions and that each of the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6646-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72334" style="width: 1.292em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.141em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.304em, 1000em, 2.381em, -0.439em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-72335"><span class="msup" id="MathJax-Span-72336"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.439em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-72337" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.662em; left: 0.811em;"><span class="mo" id="MathJax-Span-72338" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.984em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6646">K'</script> filters has dimension <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6647-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72339" style="width: 5.958em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.308em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.925em, -0.464em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72340"><span class="msubsup" id="MathJax-Span-72341"><span style="display: inline-block; position: relative; width: 1.226em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.464em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-72342" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.854em;"><span class="mi" id="MathJax-Span-72343" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-72344" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="msubsup" id="MathJax-Span-72345" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.644em, -0.466em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-72346" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.684em;"><span class="mi" id="MathJax-Span-72347" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-72348" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-72349" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.174em; vertical-align: -0.387em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6647">M_f \times N_f \times K</script>, what is the dimension of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6648-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72350" style="width: 0.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.496em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.834em, -0.43em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72351"><span class="texatom" id="MathJax-Span-72352"><span class="mrow" id="MathJax-Span-72353"><span class="mi" id="MathJax-Span-72354" style="font-family: STIXGeneral; font-weight: bold;">y</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.857em; vertical-align: -0.285em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6648">\by</script>?</li>
  <li>Note that <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6649-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72355" style="width: 0.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.64em, -0.473em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72356"><span class="mi" id="MathJax-Span-72357" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.617em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6649">x</script> is indexed by <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6650-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72358" style="width: 2.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.083em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.551em, 1000em, 2.67em, -0.397em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72359"><span class="mi" id="MathJax-Span-72360" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-72361" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msup" id="MathJax-Span-72362" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.621em; height: 0px;"><span style="position: absolute; clip: rect(1.677em, 1000em, 2.64em, -0.397em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-72363" style="font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.663em; left: 0.298em;"><span class="mo" id="MathJax-Span-72364" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.031em; vertical-align: -0.101em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6650">i+i'</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6651-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72365" style="width: 2.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.133em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.553em, 1000em, 2.836em, -0.57em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72366"><span class="mi" id="MathJax-Span-72367" style="font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-72368" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msup" id="MathJax-Span-72369" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(1.679em, 1000em, 2.836em, -0.57em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-72370" style="font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.661em; left: 0.348em;"><span class="mo" id="MathJax-Span-72371" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.215em; vertical-align: -0.287em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6651">j+j'</script>, but that there is no plus sign between <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6652-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72372" style="width: 0.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.496em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.648em, 1000em, 2.64em, -0.432em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-72373"><span class="mi" id="MathJax-Span-72374" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.888em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6652">k</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6653-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-72375" style="width: 1.014em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.893em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.274em, 1000em, 2.392em, -0.432em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-72376"><span class="msup" id="MathJax-Span-72377"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px;"><span style="position: absolute; clip: rect(1.648em, 1000em, 2.64em, -0.432em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-72378" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.692em; left: 0.551em;"><span class="mo" id="MathJax-Span-72379" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.03em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6653">k'</script>. Why?</li>
  </ul>
  
  <p><strong>Task:</strong> check that the size of the variable <code>y</code> matches your calculations.</p>
</blockquote>

<p>We can now visualize the output <code>y</code> of the convolution. In order to do this, use the <a href="http://www.vlfeat.org/matlab/vl_imarraysc.html"><code>vl_imarraysc</code></a> function to display an image for each feature channel in <code>y</code>:</p>

<pre class="prettyprint"><code class="language-matlab hljs "><span class="hljs-comment">% Visualize the output y</span>
figure(<span class="hljs-number">2</span>) ; clf ; vl_imarraysc(y) ; colormap gray ;</code></pre>

<blockquote>
  <p><strong>Question:</strong> Study the feature channels obtained. Most will likely contain a strong response in correspondences of edges in the input image <code>x</code>. Recall that <code>w</code> was obtained by drawing at random numbers from a Gaussian distribution. Can explain this phenomenon?</p>
</blockquote>

<p>So far filters preserve the resolution of the input feature map. However, it is often useful to <em>dowsnample the output</em>. This can be obtained by using the <code>stride</code> option in <code>vl_nnconv</code>:</p>



<pre class="prettyprint"><code class="language-matlab hljs "><span class="hljs-comment">% Try again, downsampling the output</span>
y_ds = vl_nnconv(x, w, <span class="hljs-matrix">[]</span>, <span class="hljs-string">'stride'</span>, <span class="hljs-number">16</span>) ;
figure(<span class="hljs-number">3</span>) ; clf ; vl_imarraysc(y_ds) ; colormap gray ;</code></pre>

<p>As you should have noticed in a question above, applying a filter to an image or feature map interacts with the boundaries, making the output map smaller by an amount proportional to the size of the filters. If this is undesirable, then the input array can be padded with zeros by using the <code>pad</code> option:</p>



<pre class="prettyprint"><code class="language-matlab hljs "><span class="hljs-comment">% Try padding</span>
y_pad = vl_nnconv(x, w, <span class="hljs-matrix">[]</span>, <span class="hljs-string">'pad'</span>, <span class="hljs-number">4</span>) ;
figure(<span class="hljs-number">4</span>) ; clf ; vl_imarraysc(y_pad) ; colormap gray ;</code></pre>

<blockquote>
  <p><strong>Task:</strong> Convince yourself that the previous code’s output has different boundaries compared to the code that does not use padding. Can you justify the result?</p>
</blockquote>

<p>In order to consolidate what learned so far, we will now design a filter by hand.</p>



<pre class="prettyprint"><code class="language-matlab hljs ">w = <span class="hljs-matrix">[<span class="hljs-number">0</span>  <span class="hljs-number">1</span> <span class="hljs-number">0</span> ;
     <span class="hljs-number">1</span> -<span class="hljs-number">4</span> <span class="hljs-number">1</span> ;
     <span class="hljs-number">0</span>  <span class="hljs-number">1</span> <span class="hljs-number">0</span> ]</span> ;
w = single(<span class="hljs-built_in">repmat</span>(w, <span class="hljs-matrix">[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>]</span>)) ;
y_lap = vl_nnconv(x, w, <span class="hljs-matrix">[]</span>) ;

figure(<span class="hljs-number">5</span>) ; clf ; colormap gray ;
subplot(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>) ; 
imagesc(y_lap) ; title(<span class="hljs-string">'filter output'</span>) ;
subplot(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>) ;
imagesc(-<span class="hljs-built_in">abs</span>(y_lap)) ; title(<span class="hljs-string">'- abs(filter output)'</span>) ;</code></pre>

<blockquote>
  <p><strong>Questions:</strong></p>
  
  <ul>
  <li>What filter have we implemented?</li>
  <li>How are the RGB colour channels processed by this filter?</li>
  <li>What image structure are detected?</li>
  </ul>
</blockquote>

<h3 id="part1-2" class="2">Part 1.2: non-linear gating</h3>

<p>As we have stated in the introduction, CNNs are obtained by composing several different functions. In addition to the linear filters shown in the <a href="#part1.1">previous part</a>, there are several non-linear convolutonal operators as well.</p>

<blockquote>
  <p><strong>Question:</strong> Some of the functions in a CNN <em>must</em> be non-linear. Why?</p>
</blockquote>

<p>The simplest non-linearity is obtained by following a linear filter by a <em>non-linear gating function</em>, applied identically to each component of a feature map. The simplest such function is the <em>Rectified Linear Unit (ReLU)</em> <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-7491-Frame" style=""><nobr><span class="math" id="MathJax-Span-82394" style="width: 8.625em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.688em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.651em, 1000em, 3.017em, -0.47em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-82395"><span class="msubsup" id="MathJax-Span-82396"><span style="display: inline-block; position: relative; width: 1.265em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.47em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-82397" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.446em;"><span class="texatom" id="MathJax-Span-82398"><span class="mrow" id="MathJax-Span-82399"><span class="mi" id="MathJax-Span-82400" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-82401" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-82402" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-82403" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-82404" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">max</span><span class="mo" id="MathJax-Span-82405" style="font-family: STIXGeneral-Regular;">{</span><span class="mn" id="MathJax-Span-82406" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-82407" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-82408" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.262em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.64em, -0.473em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-82409" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.443em;"><span class="texatom" id="MathJax-Span-82410"><span class="mrow" id="MathJax-Span-82411"><span class="mi" id="MathJax-Span-82412" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-82413" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-82414" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-82415" style="font-family: STIXGeneral-Regular;">}</span><span class="mo" id="MathJax-Span-82416" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.307em; vertical-align: -0.49em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-7491">
  y_{ijk} = \max\{0, x_{ijk}\}.
</script> <br>
This function is implemented by <code>vl_relu</code>; let’s try this out:</p>

<pre class="prettyprint"><code class="language-matlab hljs ">w = single(<span class="hljs-built_in">repmat</span>(<span class="hljs-matrix">[<span class="hljs-number">1</span> <span class="hljs-number">0</span> -<span class="hljs-number">1</span>]</span>, <span class="hljs-matrix">[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>]</span>)) ;
w = <span class="hljs-built_in">cat</span>(<span class="hljs-number">4</span>, w, -w) ;
y = vl_nnconv(x, w, <span class="hljs-matrix">[]</span>) ;
z = vl_nnrelu(y) ;

figure(<span class="hljs-number">6</span>) ; clf ; colormap gray ;
subplot(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>) ; vl_imarraysc(y) ;
subplot(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>) ; vl_imarraysc(z) ;</code></pre>

<blockquote>
  <p><strong>Tasks:</strong></p>
  
  <ul>
  <li>Run the code above and understand what the filter <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7538-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-82647" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-82648"><span class="texatom" id="MathJax-Span-82649"><span class="mrow" id="MathJax-Span-82650"><span class="mi" id="MathJax-Span-82651" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.643em; vertical-align: -0.071em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7538">\bw</script> is doing.</li>
  <li>Explain the final result <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7539-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-82652" style="width: 0.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.425em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-82653"><span class="texatom" id="MathJax-Span-82654"><span class="mrow" id="MathJax-Span-82655"><span class="mi" id="MathJax-Span-82656" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7539">\bz</script>.</li>
  </ul>
</blockquote>

<h3 id="part1-3" class="3">Part 1.3: pooling</h3>

<p>There are several other important operators in a CNN. One of them is <em>pooling</em>.  A pooling operator operates on individual feature channels, coalescing nearby feature values into one by the application of a suitable operator. Common choices include max-pooling (using the max operator) or sum-pooling (using summation). For example, <em>max-pooling</em> is defined as: <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-7478-Frame" style=""><nobr><span class="math" id="MathJax-Span-82224" style="width: 21.736em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.395em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.519em, 1000em, 3.017em, -0.47em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-82225"><span class="msubsup" id="MathJax-Span-82226"><span style="display: inline-block; position: relative; width: 1.265em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.47em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-82227" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.446em;"><span class="texatom" id="MathJax-Span-82228"><span class="mrow" id="MathJax-Span-82229"><span class="mi" id="MathJax-Span-82230" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-82231" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-82232" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-82233" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-82234" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">max</span><span class="mo" id="MathJax-Span-82235" style="font-family: STIXGeneral-Regular;">{</span><span class="msubsup" id="MathJax-Span-82236"><span style="display: inline-block; position: relative; width: 1.811em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.47em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-82237" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.446em;"><span class="texatom" id="MathJax-Span-82238"><span class="mrow" id="MathJax-Span-82239"><span class="msup" id="MathJax-Span-82240"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; clip: rect(1.67em, 1000em, 2.438em, -0.412em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-82241" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.502em; left: 0.198em;"><span class="mo" id="MathJax-Span-82242" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span><span class="msup" id="MathJax-Span-82243"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px;"><span style="position: absolute; clip: rect(1.672em, 1000em, 2.577em, -0.534em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-82244" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.5em; left: 0.249em;"><span class="mo" id="MathJax-Span-82245" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span><span class="mi" id="MathJax-Span-82246" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-82247" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">:</span><span class="mi" id="MathJax-Span-82248" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">i</span><span class="mo" id="MathJax-Span-82249" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≤</span><span class="msup" id="MathJax-Span-82250" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.621em; height: 0px;"><span style="position: absolute; clip: rect(1.677em, 1000em, 2.64em, -0.397em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-82251" style="font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.695em; left: 0.298em;"><span class="mo" id="MathJax-Span-82252" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-82253" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&lt;</span><span class="mi" id="MathJax-Span-82254" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">i</span><span class="mo" id="MathJax-Span-82255" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-82256" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">p</span><span class="mo" id="MathJax-Span-82257" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-82258" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-82259" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≤</span><span class="msup" id="MathJax-Span-82260" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.671em; height: 0px;"><span style="position: absolute; clip: rect(1.679em, 1000em, 2.836em, -0.57em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-82261" style="font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.695em; left: 0.348em;"><span class="mo" id="MathJax-Span-82262" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-82263" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&lt;</span><span class="mi" id="MathJax-Span-82264" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-82265" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-82266" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">p</span><span class="mo" id="MathJax-Span-82267" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.455em; vertical-align: -0.49em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-7478">
   y_{ijk} = \max \{ y_{i'j'k} : i \leq i' < i+p, j \leq j' < j + p \}
</script> <br>
Max pooling is implemented by the <code>vl_nnpool</code> function. Try this now:</p>



<pre class="prettyprint"><code class="language-matlab hljs ">y = vl_nnpool(x, <span class="hljs-number">15</span>) ;
figure(<span class="hljs-number">6</span>) ; clf ; imagesc(y) ;</code></pre>

<blockquote>
  <p><strong>Question:</strong> look at the resulting image. Can you interpret the result?</p>
</blockquote>

<p>The function <code>vl_nnpool</code> supports subsampling and padding just like <code>vl_nnconv</code>. However, for max-pooling feature maps are padded with the value <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7479-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-82268" style="width: 1.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.637em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.901em, 1000em, 2.629em, -0.382em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-82269"><span class="mo" id="MathJax-Span-82270" style="font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-82271" style="font-family: STIXGeneral-Regular;">∞</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.593em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7479">-\infty</script> instead of 0. Why?</p>



<h3 id="part1-4" class="4">Part 1.4: normalisation</h3>

<p>Another important CNN building block is channel-wise normalisation. This operator normalises the vector of feature channels at each spatial location in the input map <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7563-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-82839" style="width: 0.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.496em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-82840"><span class="texatom" id="MathJax-Span-82841"><span class="mrow" id="MathJax-Span-82842"><span class="mi" id="MathJax-Span-82843" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7563">\bx</script>. The form of the normalisation operator is actually rather curious: <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-7564-Frame" style=""><nobr><span class="math" id="MathJax-Span-82844" style="width: 13.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.202em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.13em, 1000em, 4.644em, -0.47em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-82845"><span class="msubsup" id="MathJax-Span-82846"><span style="display: inline-block; position: relative; width: 1.563em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.47em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-82847" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.446em;"><span class="texatom" id="MathJax-Span-82848"><span class="mrow" id="MathJax-Span-82849"><span class="mi" id="MathJax-Span-82850" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-82851" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="msup" id="MathJax-Span-82852"><span style="display: inline-block; position: relative; width: 0.652em; height: 0px;"><span style="position: absolute; clip: rect(1.65em, 1000em, 2.438em, -0.437em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-82853" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.522em; left: 0.401em;"><span class="mo" id="MathJax-Span-82854" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-82855" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-82856" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 9.074em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.428em, 1000em, 4.463em, -0.473em); top: -4.778em; left: 50%; margin-left: -0.631em;"><span class="msubsup" id="MathJax-Span-82857"><span style="display: inline-block; position: relative; width: 1.262em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.64em, -0.473em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-82858" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.443em;"><span class="texatom" id="MathJax-Span-82859"><span class="mrow" id="MathJax-Span-82860"><span class="mi" id="MathJax-Span-82861" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-82862" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-82863" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span><span style="position: absolute; clip: rect(2.49em, 1000em, 4.839em, -0.307em); top: -2.675em; left: 50%; margin-left: -4.477em;"><span class="msubsup" id="MathJax-Span-82864"><span style="display: inline-block; position: relative; width: 8.954em; height: 0px;"><span style="position: absolute; clip: rect(2.101em, 1000em, 4.244em, -0.307em); top: -3.423em; left: 0em;"><span class="mrow" id="MathJax-Span-82865"><span class="mo" id="MathJax-Span-82866" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">(</span></span><span class="mi" id="MathJax-Span-82867" style="font-family: STIXGeneral-Italic;">κ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.021em;"></span></span><span class="mo" id="MathJax-Span-82868" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-82869" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">α</span><span class="munderover" id="MathJax-Span-82870" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 3.448em; height: 0px;"><span style="position: absolute; clip: rect(1.521em, 1000em, 2.84em, -0.388em); top: -2.431em; left: 0em;"><span class="mo" id="MathJax-Span-82871" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.985em; left: 0.942em;"><span class="texatom" id="MathJax-Span-82872"><span class="mrow" id="MathJax-Span-82873"><span class="mi" id="MathJax-Span-82874" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-82875" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-82876" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">G</span><span class="mo" id="MathJax-Span-82877" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-82878"><span style="display: inline-block; position: relative; width: 0.652em; height: 0px;"><span style="position: absolute; clip: rect(1.65em, 1000em, 2.438em, -0.437em); top: -2.282em; left: 0em;"><span class="mi" id="MathJax-Span-82879" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; top: -2.522em; left: 0.401em;"><span class="mo" id="MathJax-Span-82880" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span></span><span class="mo" id="MathJax-Span-82881" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-82882" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.262em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.64em, -0.473em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-82883" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.655em, 1000em, 2.431em, -0.426em); top: -2.626em; left: 0.497em;"><span class="mn" id="MathJax-Span-82884" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.65em, 1000em, 2.577em, -0.412em); top: -1.963em; left: 0.443em;"><span class="texatom" id="MathJax-Span-82885"><span class="mrow" id="MathJax-Span-82886"><span class="mi" id="MathJax-Span-82887" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-82888" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-82889" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-82890" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.423em;"></span></span><span style="position: absolute; top: -3.181em; left: 8.482em;"><span class="texatom" id="MathJax-Span-82891"><span class="mrow" id="MathJax-Span-82892"><span class="mi" id="MathJax-Span-82893" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 9.074em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.714em; vertical-align: -2.313em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-7564">
  y_{ijk'} = \frac{x_{ijk}}{\left(\kappa + \alpha \sum_{k\in G(k')}  x_{ijk}^2\right)^{\beta}}
</script> <br>
where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7565-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-82894" style="width: 19.736em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.609em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(2em, 1000em, 3.651em, -0.394em); top: -3.075em; left: 0em;"><span class="mrow" id="MathJax-Span-82895"><span class="mi" id="MathJax-Span-82896" style="font-family: STIXGeneral-Italic;">G</span><span class="mo" id="MathJax-Span-82897" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-82898" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-82899" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-82900" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mrow" id="MathJax-Span-82901" style="padding-left: 0.313em;"><span class="mo" id="MathJax-Span-82902" style="vertical-align: -0.246em; padding-left: 0.284em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">[</span></span></span><span class="mi" id="MathJax-Span-82903" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-82904" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mo" id="MathJax-Span-82905" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">⌊</span><span class="mfrac" id="MathJax-Span-82906"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.821em, 1000em, 2.576em, -0.475em); top: -2.83em; left: 50%; margin-left: -0.198em;"><span class="mi" id="MathJax-Span-82907" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ρ</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.655em, 1000em, 2.431em, -0.426em); top: -1.901em; left: 50%; margin-left: -0.174em;"><span class="mn" id="MathJax-Span-82908" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 0.517em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-82909" style="font-family: STIXGeneral-Regular;">⌋</span><span class="mo" id="MathJax-Span-82910" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-82911" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-82912" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-82913" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">⌈</span><span class="mfrac" id="MathJax-Span-82914"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.821em, 1000em, 2.576em, -0.475em); top: -2.83em; left: 50%; margin-left: -0.198em;"><span class="mi" id="MathJax-Span-82915" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ρ</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.655em, 1000em, 2.431em, -0.426em); top: -1.901em; left: 50%; margin-left: -0.174em;"><span class="mn" id="MathJax-Span-82916" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 0.517em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-82917" style="font-family: STIXGeneral-Regular;">⌉</span><span class="mo" id="MathJax-Span-82918" style="vertical-align: -0.246em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">]</span></span></span></span><span class="mo" id="MathJax-Span-82919" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∩</span><span class="mo" id="MathJax-Span-82920" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">{</span><span class="mn" id="MathJax-Span-82921" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-82922" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-82923" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">2</span><span class="mo" id="MathJax-Span-82924" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-82925" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-82926" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="mi" id="MathJax-Span-82927" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-82928" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 3.075em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.626em; vertical-align: -0.533em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7565">G(k) = \left[k - \lfloor \frac{\rho}{2} \rfloor, k + \lceil \frac{\rho}{2} \rceil\right] \cap \{1, 2, \dots, K\}</script> is a group of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7566-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-82929" style="width: 0.625em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.834em, -0.486em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-82930"><span class="mi" id="MathJax-Span-82931" style="font-family: STIXGeneral-Italic;">ρ</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.835em; vertical-align: -0.285em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7566">\rho</script> consecutive feature channels in the input map.</p>

<blockquote>
  <p><strong>Task:</strong> Understand what this operator is doing. How would you set <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7567-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-82932" style="width: 0.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.501em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.911em, 1000em, 2.666em, -0.436em); top: -2.503em; left: 0em;"><span class="mrow" id="MathJax-Span-82933"><span class="mi" id="MathJax-Span-82934" style="font-family: STIXGeneral-Italic;">κ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.021em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.615em; vertical-align: -0.07em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7567">\kappa</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7568-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-82935" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.911em, 1000em, 2.664em, -0.423em); top: -2.503em; left: 0em;"><span class="mrow" id="MathJax-Span-82936"><span class="mi" id="MathJax-Span-82937" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.613em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7568">\alpha</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7569-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-82938" style="width: 0.625em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.551em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.674em, 1000em, 2.858em, -0.49em); top: -2.503em; left: 0em;"><span class="mrow" id="MathJax-Span-82939"><span class="mi" id="MathJax-Span-82940" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.091em; vertical-align: -0.283em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7569">\beta</script> to achieve simple <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7570-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-82941" style="width: 1.236em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.101em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.244em, 1000em, 2.402em, -0.458em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-82942"><span class="msubsup" id="MathJax-Span-82943"><span style="display: inline-block; position: relative; width: 1.077em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.653em, -0.458em); top: -2.503em; left: 0em;"><span class="mi" id="MathJax-Span-82944" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.682em; left: 0.652em;"><span class="mn" id="MathJax-Span-82945" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.252em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.063em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7570">L^2</script> normalisation?</p>
</blockquote>

<p>Now let’s try this out:</p>

<pre class="prettyprint"><code class="language-matlab hljs ">rho = <span class="hljs-number">5</span> ;
kappa = <span class="hljs-number">0</span> ;
alpha = <span class="hljs-number">1</span> ;
<span class="hljs-built_in">beta</span> = <span class="hljs-number">0.5</span> ;
y_nrm = vl_nnnormalize(x, <span class="hljs-matrix">[rho kappa alpha beta]</span>) ;
figure(<span class="hljs-number">6</span>) ; clf ; imagesc(y_nrm) ;</code></pre>

<blockquote>
  <p><strong>Tasks:</strong> </p>
  
  <ul>
  <li>Inspect the figure just obtained. Can you interpret it?</li>
  <li>Compute the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7614-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-83127" style="width: 1.236em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.091em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.225em, 1000em, 2.381em, -0.454em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-83128"><span class="msubsup" id="MathJax-Span-83129"><span style="display: inline-block; position: relative; width: 1.068em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.454em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-83130" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.662em; left: 0.646em;"><span class="mn" id="MathJax-Span-83131" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7614">L^2</script> norm of the feature channels in the output map <code>y_nrm</code>. What do you notice? </li>
  <li>Explain this result in relation to the particular choice of the parameters <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7615-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-83132" style="width: 0.625em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.834em, -0.486em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-83133"><span class="mi" id="MathJax-Span-83134" style="font-family: STIXGeneral-Italic;">ρ</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.835em; vertical-align: -0.285em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7615">\rho</script>,  <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7616-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-83135" style="width: 0.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.496em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.642em, -0.432em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-83136"><span class="mi" id="MathJax-Span-83137" style="font-family: STIXGeneral-Italic;">κ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.021em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.62em; vertical-align: -0.07em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7616">\kappa</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7617-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-83138" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.64em, -0.419em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-83139"><span class="mi" id="MathJax-Span-83140" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.617em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7617">\alpha</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7618-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-83141" style="width: 0.625em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.834em, -0.486em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-83142"><span class="mi" id="MathJax-Span-83143" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.1em; vertical-align: -0.285em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7618">\beta</script>.</li>
  </ul>
</blockquote>

<h2 id="part-2-back-propagation-and-derivatives">Part 2: back-propagation and derivatives</h2>

<p>The parameters of a CNN <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22872-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300488" style="width: 7.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.696em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.655em, 1000em, 2.806em, -0.423em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300489"><span class="texatom" id="MathJax-Span-300490"><span class="mrow" id="MathJax-Span-300491"><span class="mi" id="MathJax-Span-300492" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-300493" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-300494" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">(</span><span class="msubsup" id="MathJax-Span-300495"><span style="display: inline-block; position: relative; width: 1.166em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300496"><span class="mrow" id="MathJax-Span-300497"><span class="mi" id="MathJax-Span-300498" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mn" id="MathJax-Span-300499" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300500" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-300501" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="msubsup" id="MathJax-Span-300502" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.216em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300503"><span class="mrow" id="MathJax-Span-300504"><span class="mi" id="MathJax-Span-300505" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mi" id="MathJax-Span-300506" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300507" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.066em; vertical-align: -0.254em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22872">\bw=(\bw_1,\dots\bw_L)</script> should be learned in such a manner that the overall CNN function  <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22873-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300508" style="width: 5.069em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.514em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.425em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300509"><span class="texatom" id="MathJax-Span-300510"><span class="mrow" id="MathJax-Span-300511"><span class="mi" id="MathJax-Span-300512" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-300513" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-300514" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-300515" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-300516"><span class="mrow" id="MathJax-Span-300517"><span class="mi" id="MathJax-Span-300518" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-300519" style="font-family: STIXGeneral-Regular;">;</span><span class="texatom" id="MathJax-Span-300520" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-300521"><span class="mi" id="MathJax-Span-300522" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-300523" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.102em; vertical-align: -0.287em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22873">\bz = f(\bx;\bw)</script> achieves a desired goal. In some cases,  the goal is to model the distribution of the data, which leads to a <em>generative objective</em>. Here, however, we will use <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22874-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300524" style="width: 0.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300525"><span class="mi" id="MathJax-Span-300526" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.102em; vertical-align: -0.287em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22874">f</script> as a <em>regressor</em> and obtain it by minimising a <em>discriminative objective</em>. In simple terms, we are given:</p>

<ul>
<li>examples of the desired input-output relations <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22875-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300527" style="width: 8.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.837em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.655em, 1000em, 2.806em, -0.398em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300528"><span class="mo" id="MathJax-Span-300529" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-300530"><span style="display: inline-block; position: relative; width: 0.918em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300531"><span class="mrow" id="MathJax-Span-300532"><span class="mi" id="MathJax-Span-300533" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mn" id="MathJax-Span-300534" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300535" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-300536" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.425em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300537"><span class="mrow" id="MathJax-Span-300538"><span class="mi" id="MathJax-Span-300539" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.446em;"><span class="mn" id="MathJax-Span-300540" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300541" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-300542" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-300543" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-300544" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="mo" id="MathJax-Span-300545" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">(</span><span class="msubsup" id="MathJax-Span-300546"><span style="display: inline-block; position: relative; width: 0.918em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300547"><span class="mrow" id="MathJax-Span-300548"><span class="mi" id="MathJax-Span-300549" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mi" id="MathJax-Span-300550" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300551" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-300552" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.425em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300553"><span class="mrow" id="MathJax-Span-300554"><span class="mi" id="MathJax-Span-300555" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.446em;"><span class="mi" id="MathJax-Span-300556" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300557" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.066em; vertical-align: -0.254em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22875">(\bx_1,\bz_1), \dots, (\bx_n,\bz_n)</script> where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22876-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300558" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.539em, -0.434em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-300559"><span class="msubsup" id="MathJax-Span-300560"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300561"><span class="mrow" id="MathJax-Span-300562"><span class="mi" id="MathJax-Span-300563" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mi" id="MathJax-Span-300564" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.804em; vertical-align: -0.232em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22876">\bx_i</script> are input data and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22877-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300565" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.539em, -0.425em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-300566"><span class="msubsup" id="MathJax-Span-300567"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.425em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300568"><span class="mrow" id="MathJax-Span-300569"><span class="mi" id="MathJax-Span-300570" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.446em;"><span class="mi" id="MathJax-Span-300571" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.804em; vertical-align: -0.232em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22877">\bz_i</script> corresponding output labels;</li>
<li>and a loss <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22878-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300572" style="width: 2.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.579em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.579em, 1000em, 2.806em, -0.398em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300573"><span class="mi" id="MathJax-Span-300574" style="font-family: STIXGeneral-Italic;">ℓ</span><span class="mo" id="MathJax-Span-300575" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-300576"><span class="mrow" id="MathJax-Span-300577"><span class="mi" id="MathJax-Span-300578" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-300579" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-300580" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-300581"><span class="munderover" id="MathJax-Span-300582"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.425em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300583"><span class="mrow" id="MathJax-Span-300584"><span class="mi" id="MathJax-Span-300585" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -4.096em; left: 0.068em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-300586" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.645em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-300587" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.152em; vertical-align: -0.254em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22878">\ell(\bz,\hat\bz)</script> that expresses the penalty for predicting <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22879-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300588" style="width: 0.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.331em, 1000em, 2.381em, -0.765em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-300589"><span class="texatom" id="MathJax-Span-300590"><span class="mrow" id="MathJax-Span-300591"><span class="munderover" id="MathJax-Span-300592"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.425em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300593"><span class="mrow" id="MathJax-Span-300594"><span class="mi" id="MathJax-Span-300595" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -4.096em; left: 0.068em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-300596" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.645em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22879">\hat\bz</script> instead of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22880-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300597" style="width: 0.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.425em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300598"><span class="texatom" id="MathJax-Span-300599"><span class="mrow" id="MathJax-Span-300600"><span class="mi" id="MathJax-Span-300601" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22880">\bz</script>.</li>
</ul>

<p>We use those to write the empirical loss of the CNN <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22881-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300602" style="width: 0.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300603"><span class="mi" id="MathJax-Span-300604" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.102em; vertical-align: -0.287em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22881">f</script> by averaging over the examples: <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-22882-Frame" style=""><nobr><span class="math" id="MathJax-Span-300605" style="width: 12.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.21em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(0.72em, 1000em, 3.887em, -0.454em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300606"><span class="mi" id="MathJax-Span-300607" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-300608" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-300609"><span class="mrow" id="MathJax-Span-300610"><span class="mi" id="MathJax-Span-300611" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-300612" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-300613" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-300614" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.655em, 1000em, 2.629em, -0.335em); top: -3.157em; left: 50%; margin-left: -0.248em;"><span class="mn" id="MathJax-Span-300615" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.89em, 1000em, 2.638em, -0.432em); top: -1.794em; left: 50%; margin-left: -0.248em;"><span class="mi" id="MathJax-Span-300616" style="font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 0.616em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="munderover" id="MathJax-Span-300617" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.29em; height: 0px;"><span style="position: absolute; clip: rect(1.753em, 1000em, 3.501em, -0.356em); top: -2.877em; left: 0em;"><span class="mo" id="MathJax-Span-300618" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.877em;"></span></span><span style="position: absolute; clip: rect(1.655em, 1000em, 2.538em, -0.412em); top: -1.132em; left: 0.124em;"><span class="texatom" id="MathJax-Span-300619"><span class="mrow" id="MathJax-Span-300620"><span class="mi" id="MathJax-Span-300621" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-300622" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-300623" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.721em, 1000em, 2.437em, -0.437em); top: -3.482em; left: 0.471em;"><span class="mi" id="MathJax-Span-300624" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mi" id="MathJax-Span-300625" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ℓ</span><span class="mo" id="MathJax-Span-300626" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-300627"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.425em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300628"><span class="mrow" id="MathJax-Span-300629"><span class="mi" id="MathJax-Span-300630" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.446em;"><span class="mi" id="MathJax-Span-300631" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300632" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-300633" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-300634" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-300635"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300636"><span class="mrow" id="MathJax-Span-300637"><span class="mi" id="MathJax-Span-300638" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mi" id="MathJax-Span-300639" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300640" style="font-family: STIXGeneral-Regular;">;</span><span class="texatom" id="MathJax-Span-300641" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-300642"><span class="mi" id="MathJax-Span-300643" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-300644" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-300645" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.325em; vertical-align: -1.464em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-22882">
L(\bw) = \frac{1}{n} \sum_{i=1}^n \ell(\bz_i, f(\bx_i;\bw))
</script> <br>
Note that the composition of the function <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22883-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300646" style="width: 0.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300647"><span class="mi" id="MathJax-Span-300648" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.102em; vertical-align: -0.287em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22883">f</script> with the loss <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22884-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300649" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.644em, 1000em, 2.64em, -0.398em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300650"><span class="mi" id="MathJax-Span-300651" style="font-family: STIXGeneral-Italic;">ℓ</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.893em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22884">\ell</script> can be though of as a CNN with one more layer (called a <em>loss layer</em>). Hence, with a slight abuse of notation, in the rest of this part we incorporate the loss in the function <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22885-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300652" style="width: 0.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300653"><span class="mi" id="MathJax-Span-300654" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.102em; vertical-align: -0.287em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22885">f</script> (which therefore is a map <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22886-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300655" style="width: 3.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.026em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(2.155em, 1000em, 3.138em, -0.408em); top: -2.976em; left: 0em;"><span class="mrow" id="MathJax-Span-300656"><span class="texatom" id="MathJax-Span-300657"><span class="mrow" id="MathJax-Span-300658"><span class="mi" id="MathJax-Span-300659" style="font-family: STIXNonUnicode-Italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span></span></span><span class="mo" id="MathJax-Span-300660" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="texatom" id="MathJax-Span-300661" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-300662"><span class="mi" id="MathJax-Span-300663" style="font-family: STIXGeneral-Regular;">ℝ</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.976em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.878em; vertical-align: -0.07em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22886">\mathcal{X}\rightarrow\mathbb{R}</script>) and do not talk about it explicitly anymore.</p>

<p>The simplest algorithm to minimse <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22887-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300664" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.454em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300665"><span class="mi" id="MathJax-Span-300666" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22887">L</script>, and in fact one that is used in practice, is <em>gradient descent</em>. The idea is simple: compute the gradient of the objective <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22888-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300667" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.454em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300668"><span class="mi" id="MathJax-Span-300669" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22888">L</script> at a current solution <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22889-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300670" style="width: 1.236em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.091em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.334em, 1000em, 2.395em, -0.423em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-300671"><span class="msubsup" id="MathJax-Span-300672"><span style="display: inline-block; position: relative; width: 1.067em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300673"><span class="mrow" id="MathJax-Span-300674"><span class="mi" id="MathJax-Span-300675" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.645em; left: 0.744em;"><span class="mi" id="MathJax-Span-300676" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.966em; vertical-align: -0.071em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22889">\bw^t</script> and then update the latter along the direction of fastest descent of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22890-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300677" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.454em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300678"><span class="mi" id="MathJax-Span-300679" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22890">L</script>: <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-22891-Frame" style=""><nobr><span class="math" id="MathJax-Span-300680" style="width: 11.125em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.921em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(0.977em, 1000em, 3.329em, -0.423em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300681"><span class="msubsup" id="MathJax-Span-300682"><span style="display: inline-block; position: relative; width: 1.861em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300683"><span class="mrow" id="MathJax-Span-300684"><span class="mi" id="MathJax-Span-300685" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.695em; left: 0.744em;"><span class="texatom" id="MathJax-Span-300686"><span class="mrow" id="MathJax-Span-300687"><span class="mi" id="MathJax-Span-300688" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-300689" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-300690" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300691" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-300692" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.067em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300693"><span class="mrow" id="MathJax-Span-300694"><span class="mi" id="MathJax-Span-300695" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.695em; left: 0.744em;"><span class="texatom" id="MathJax-Span-300696"><span class="mrow" id="MathJax-Span-300697"><span class="mi" id="MathJax-Span-300698" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300699" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-300700" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.819em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.834em, -0.432em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-300701" style="font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.041em; left: 0.496em;"><span class="mi" id="MathJax-Span-300702" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-300703" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.31em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.406em); top: -3.157em; left: 50%; margin-left: -0.446em;"><span class="mrow" id="MathJax-Span-300704"><span class="mi" id="MathJax-Span-300705" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-300706" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.663em, 1000em, 2.643em, -0.406em); top: -1.794em; left: 50%; margin-left: -0.595em;"><span class="mrow" id="MathJax-Span-300707"><span class="mi" id="MathJax-Span-300708" style="font-family: STIXGeneral-Regular;">∂</span><span class="texatom" id="MathJax-Span-300709"><span class="mrow" id="MathJax-Span-300710"><span class="mi" id="MathJax-Span-300711" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 1.31em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-300712" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">(</span><span class="msubsup" id="MathJax-Span-300713"><span style="display: inline-block; position: relative; width: 1.067em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300714"><span class="mrow" id="MathJax-Span-300715"><span class="mi" id="MathJax-Span-300716" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.695em; left: 0.744em;"><span class="mi" id="MathJax-Span-300717" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300718" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.412em; vertical-align: -0.84em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-22891">
 \bw^{t+1} = \bw^{t} - \eta_t \frac{\partial f}{\partial \bw}(\bw^t)
</script> <br>
where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22892-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-300719" style="width: 3.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.472em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.669em, 1000em, 2.877em, -0.432em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-300720"><span class="msubsup" id="MathJax-Span-300721"><span style="display: inline-block; position: relative; width: 0.819em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.834em, -0.432em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-300722" style="font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.041em; left: 0.496em;"><span class="mi" id="MathJax-Span-300723" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-300724" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-300725" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.315em; height: 0px;"><span style="position: absolute; clip: rect(1.669em, 1000em, 2.629em, -0.376em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-300726"><span class="mrow" id="MathJax-Span-300727"><span class="mi" id="MathJax-Span-300728" style="font-family: STIXGeneral-Regular;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mo" id="MathJax-Span-300729" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.13em; vertical-align: -0.333em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22892">\eta_t \in \mathbb{R}_+</script> is the <em>learning rate</em>.</p>

<h3 id="part-21-theory">Part 2.1: Theory</h3>

<p>The basic computational problem to solve is the calculation of the gradient of the function with respect to the parameter <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34575-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528427" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528428"><span class="texatom" id="MathJax-Span-528429"><span class="mrow" id="MathJax-Span-528430"><span class="mi" id="MathJax-Span-528431" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.643em; vertical-align: -0.071em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34575">\bw</script>. Since <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34576-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528432" style="width: 0.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528433"><span class="mi" id="MathJax-Span-528434" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.102em; vertical-align: -0.287em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34576">f</script> is the composition of several functions, the key ingredient is the <em>chain rule</em>: <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34577-Frame" style=""><nobr><span class="math" id="MathJax-Span-528435" style="width: 23.069em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.585em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(-0.703em, 1000em, 4.668em, -0.279em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-528436"><span class="mtable" id="MathJax-Span-528437" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 20.251em; height: 0px;"><span style="position: absolute; clip: rect(2.025em, 1000em, 6.272em, -0.446em); top: -4.96em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(2.515em, 1000em, 5.01em, -0.446em); top: -5.45em; right: 0em;"><span class="mtd" id="MathJax-Span-528438"><span class="mrow" id="MathJax-Span-528439"><span class="mfrac" id="MathJax-Span-528440"><span style="display: inline-block; position: relative; width: 1.608em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.406em); top: -3.157em; left: 50%; margin-left: -0.446em;"><span class="mrow" id="MathJax-Span-528441"><span class="mi" id="MathJax-Span-528442" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528443" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.663em, 1000em, 2.787em, -0.406em); top: -1.794em; left: 50%; margin-left: -0.744em;"><span class="mrow" id="MathJax-Span-528444"><span class="mi" id="MathJax-Span-528445" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528446"><span style="display: inline-block; position: relative; width: 1.017em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528447"><span class="mrow" id="MathJax-Span-528448"><span class="mi" id="MathJax-Span-528449" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mi" id="MathJax-Span-528450" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 1.608em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span><span style="position: absolute; clip: rect(3.869em, 1000em, 4.167em, -0.446em); top: -2.855em; right: 0em;"><span class="mtd" id="MathJax-Span-528504"><span class="mrow" id="MathJax-Span-528505"></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.96em;"></span></span><span style="position: absolute; clip: rect(3.126em, 1000em, 8.487em, -0.148em); top: -6.052em; left: 1.848em;"><span style="display: inline-block; position: relative; width: 18.403em; height: 0px;"><span style="position: absolute; clip: rect(0.987em, 1000em, 3.473em, -0.148em); top: -3.912em; left: 0em;"><span class="mtd" id="MathJax-Span-528451"><span class="mrow" id="MathJax-Span-528452"><span class="mo" id="MathJax-Span-528453" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="mfrac" id="MathJax-Span-528454"><span style="display: inline-block; position: relative; width: 1.608em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.663em, 1000em, 2.64em, -0.406em); top: -3.157em; left: 50%; margin-left: -0.248em;"><span class="mi" id="MathJax-Span-528455" style="font-family: STIXGeneral-Regular;">∂</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.663em, 1000em, 2.787em, -0.406em); top: -1.794em; left: 50%; margin-left: -0.744em;"><span class="mrow" id="MathJax-Span-528456"><span class="mi" id="MathJax-Span-528457" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528458"><span style="display: inline-block; position: relative; width: 1.017em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528459"><span class="mrow" id="MathJax-Span-528460"><span class="mi" id="MathJax-Span-528461" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mi" id="MathJax-Span-528462" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 1.608em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-528463" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528464" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-528465" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528466" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-528467" style="font-family: STIXGeneral-Regular;">…</span><span class="msubsup" id="MathJax-Span-528468" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528469" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mn" id="MathJax-Span-528470" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528471" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-528472"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528473" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mn" id="MathJax-Span-528474" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528475" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-528476"><span class="mrow" id="MathJax-Span-528477"><span class="mi" id="MathJax-Span-528478" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-528479" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-528480" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.166em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528481"><span class="mrow" id="MathJax-Span-528482"><span class="mi" id="MathJax-Span-528483" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mn" id="MathJax-Span-528484" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528485" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-528486" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-528487" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.166em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528488"><span class="mrow" id="MathJax-Span-528489"><span class="mi" id="MathJax-Span-528490" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mn" id="MathJax-Span-528491" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528492" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-528493" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-528494" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-528495" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-528496" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.216em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528497"><span class="mrow" id="MathJax-Span-528498"><span class="mi" id="MathJax-Span-528499" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="texatom" id="MathJax-Span-528500"><span class="mrow" id="MathJax-Span-528501"><span class="mi" id="MathJax-Span-528502" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528503" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.918em, 1000em, 3.753em, -0.148em); top: -1.318em; left: 0em;"><span class="mtd" id="MathJax-Span-528506"><span class="mrow" id="MathJax-Span-528507"><span class="mo" id="MathJax-Span-528508" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="mfrac" id="MathJax-Span-528509"><span style="display: inline-block; position: relative; width: 3.394em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.871em, -0.406em); top: -3.187em; left: 50%; margin-left: -1.488em;"><span class="mrow" id="MathJax-Span-528510"><span class="mi" id="MathJax-Span-528511" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528512" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="mo" id="MathJax-Span-528513"></span><span class="msubsup" id="MathJax-Span-528514" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528515" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-528516" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.519em, 1000em, 2.926em, -0.406em); top: -1.704em; left: 50%; margin-left: -1.637em;"><span class="mrow" id="MathJax-Span-528517"><span class="mi" id="MathJax-Span-528518" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528519" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="msubsup" id="MathJax-Span-528520" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.067em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528521"><span class="mrow" id="MathJax-Span-528522"><span class="mi" id="MathJax-Span-528523" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.665em, 1000em, 2.431em, -0.412em); top: -2.626em; left: 0.496em;"><span class="mi" id="MathJax-Span-528524" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.671em, 1000em, 2.431em, -0.452em); top: -1.984em; left: 0.496em;"><span class="mi" id="MathJax-Span-528525" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 3.394em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-528526" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 4.138em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.871em, -0.406em); top: -3.187em; left: 50%; margin-left: -1.91em;"><span class="mrow" id="MathJax-Span-528527"><span class="mi" id="MathJax-Span-528528" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528529" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="mo" id="MathJax-Span-528530"></span><span class="msubsup" id="MathJax-Span-528531" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528532" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="texatom" id="MathJax-Span-528533"><span class="mrow" id="MathJax-Span-528534"><span class="mi" id="MathJax-Span-528535" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-528536" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-528537" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.519em, 1000em, 2.943em, -0.406em); top: -1.704em; left: 50%; margin-left: -2.009em;"><span class="mrow" id="MathJax-Span-528538"><span class="mi" id="MathJax-Span-528539" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528540" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="msubsup" id="MathJax-Span-528541" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.811em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528542"><span class="mrow" id="MathJax-Span-528543"><span class="mi" id="MathJax-Span-528544" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.665em, 1000em, 2.431em, -0.412em); top: -2.626em; left: 0.496em;"><span class="mi" id="MathJax-Span-528545" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.655em, 1000em, 2.431em, -0.452em); top: -1.968em; left: 0.496em;"><span class="texatom" id="MathJax-Span-528546"><span class="mrow" id="MathJax-Span-528547"><span class="mi" id="MathJax-Span-528548" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-528549" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-528550" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 4.138em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-528551" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mfrac" id="MathJax-Span-528552" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 3.939em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.9em, -0.406em); top: -3.216em; left: 50%; margin-left: -1.811em;"><span class="mrow" id="MathJax-Span-528553"><span class="mi" id="MathJax-Span-528554" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528555" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="mo" id="MathJax-Span-528556"></span><span class="msubsup" id="MathJax-Span-528557" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.417em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528558" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="texatom" id="MathJax-Span-528559"><span class="mrow" id="MathJax-Span-528560"><span class="mi" id="MathJax-Span-528561" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528562" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528563" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.519em, 1000em, 2.976em, -0.406em); top: -1.704em; left: 50%; margin-left: -1.91em;"><span class="mrow" id="MathJax-Span-528564"><span class="mi" id="MathJax-Span-528565" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528566" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="msubsup" id="MathJax-Span-528567" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.613em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528568"><span class="mrow" id="MathJax-Span-528569"><span class="mi" id="MathJax-Span-528570" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.665em, 1000em, 2.431em, -0.412em); top: -2.626em; left: 0.496em;"><span class="mi" id="MathJax-Span-528571" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.65em, 1000em, 2.46em, -0.417em); top: -1.963em; left: 0.496em;"><span class="texatom" id="MathJax-Span-528572"><span class="mrow" id="MathJax-Span-528573"><span class="mi" id="MathJax-Span-528574" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528575" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528576" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 3.939em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-528577" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.898em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.879em, -0.406em); top: -3.194em; left: 50%; margin-left: -1.389em;"><span class="mrow" id="MathJax-Span-528578"><span class="mi" id="MathJax-Span-528579" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528580" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="mo" id="MathJax-Span-528581"></span><span class="msubsup" id="MathJax-Span-528582" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528583" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-528584" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.519em, 1000em, 2.955em, -0.406em); top: -1.704em; left: 50%; margin-left: -0.893em;"><span class="mrow" id="MathJax-Span-528585"><span class="mi" id="MathJax-Span-528586" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528587"><span style="display: inline-block; position: relative; width: 1.315em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528588"><span class="mrow" id="MathJax-Span-528589"><span class="mi" id="MathJax-Span-528590" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.665em, 1000em, 2.431em, -0.412em); top: -2.626em; left: 0.744em;"><span class="mi" id="MathJax-Span-528591" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.65em, 1000em, 2.438em, -0.417em); top: -1.963em; left: 0.744em;"><span class="mi" id="MathJax-Span-528592" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 2.898em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.052em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.793em; vertical-align: -2.617em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-34577">
\begin{align}
 \frac{\partial f}{\partial \bw_l} &= 
  \frac{\partial}{\partial \bw_l}
  f_L(\dots f_2(f_1(\bx;\bw_1);\bw_2)\dots),\bw_{L})
  \\
  &= 
  \frac{\partial \vc f_L}{\partial \vc\bx_L^\top}
  \frac{\partial \vc f_{L-1}}{\partial \vc\bx_{L-1}^\top}
  \dots
  \frac{\partial \vc f_{l+1}}{\partial \vc\bx_{l+1}^\top}
  \frac{\partial \vc f_l}{\partial \bw_l^\top}
\end{align}
</script> <br>
The notation requires some explanation. Recall that each function <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34578-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528593" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.405em, 1000em, 2.631em, -0.593em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-528594"><span class="msubsup" id="MathJax-Span-528595"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528596" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-528597" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.151em; vertical-align: -0.336em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34578">f_l</script> is a map from a <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34579-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528598" style="width: 5.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.613em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.654em, -0.464em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528599"><span class="mi" id="MathJax-Span-528600" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mo" id="MathJax-Span-528601" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-528602" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-528603" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-528604" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.084em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34579">M\times N\times K</script> array to a <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34580-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528605" style="width: 6.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.853em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.552em, 1000em, 2.654em, -0.464em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528606"><span class="msup" id="MathJax-Span-528607"><span style="display: inline-block; position: relative; width: 1.278em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.464em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528608" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.662em; left: 0.955em;"><span class="mo" id="MathJax-Span-528609" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528610" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="msup" id="MathJax-Span-528611" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.135em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.644em, -0.466em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528612" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.662em; left: 0.812em;"><span class="mo" id="MathJax-Span-528613" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528614" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="msup" id="MathJax-Span-528615" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.439em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528616" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.662em; left: 0.811em;"><span class="mo" id="MathJax-Span-528617" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.084em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34580">M' \times N' \times K'</script> array. The operator <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34581-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528618" style="width: 1.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.389em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.871em, 1000em, 2.643em, -0.427em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528619"><span class="mi" id="MathJax-Span-528620" style="font-family: STIXGeneral-Regular;">vec</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.642em; vertical-align: -0.071em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34581">\vc</script> <em>vectorises</em> such arrays by stacking their elments in a column vector (the stacking order is arbitrary but conventionally column-major). The symbol <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34582-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528621" style="width: 7.125em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.349em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.519em, 1000em, 2.955em, -0.406em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528622"><span class="mi" id="MathJax-Span-528623" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528624" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="mo" id="MathJax-Span-528625"></span><span class="msubsup" id="MathJax-Span-528626" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528627" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-528628" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="texatom" id="MathJax-Span-528629"><span class="mrow" id="MathJax-Span-528630"><span class="mo" id="MathJax-Span-528631" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-528632" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528633" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="msubsup" id="MathJax-Span-528634" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.067em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528635"><span class="mrow" id="MathJax-Span-528636"><span class="mi" id="MathJax-Span-528637" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.665em, 1000em, 2.431em, -0.412em); top: -2.626em; left: 0.496em;"><span class="mi" id="MathJax-Span-528638" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.65em, 1000em, 2.438em, -0.417em); top: -1.963em; left: 0.496em;"><span class="mi" id="MathJax-Span-528639" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.387em; vertical-align: -0.421em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34582">\partial \vc f_l / \partial \vc \bx_l^\top</script> then denotes the derivative of a column vector of output variables by a row vector of input variables. Note that <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34583-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528640" style="width: 1.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.539em, -0.423em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-528641"><span class="msubsup" id="MathJax-Span-528642"><span style="display: inline-block; position: relative; width: 1.017em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528643"><span class="mrow" id="MathJax-Span-528644"><span class="mi" id="MathJax-Span-528645" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mi" id="MathJax-Span-528646" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.804em; vertical-align: -0.232em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34583">\bw_l</script> is already assumed to be a column vector so it does not require explicit vectorisation.</p>

<blockquote>
  <p><strong>Questions:</strong> Make sure you understand the structure of this formula and answer the following:</p>
  
  <ul>
  <li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34584-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528647" style="width: 7.125em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.349em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.519em, 1000em, 2.955em, -0.406em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528648"><span class="mi" id="MathJax-Span-528649" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528650" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="mo" id="MathJax-Span-528651"></span><span class="msubsup" id="MathJax-Span-528652" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528653" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-528654" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="texatom" id="MathJax-Span-528655"><span class="mrow" id="MathJax-Span-528656"><span class="mo" id="MathJax-Span-528657" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-528658" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528659" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="msubsup" id="MathJax-Span-528660" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.067em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528661"><span class="mrow" id="MathJax-Span-528662"><span class="mi" id="MathJax-Span-528663" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.665em, 1000em, 2.431em, -0.412em); top: -2.626em; left: 0.496em;"><span class="mi" id="MathJax-Span-528664" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.65em, 1000em, 2.438em, -0.417em); top: -1.963em; left: 0.496em;"><span class="mi" id="MathJax-Span-528665" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.387em; vertical-align: -0.421em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34584">\partial \vc f_l / \partial \vc \bx_l^\top</script> is a matrix. What are its dimensions?</li>
  <li>The formula can be rewritten with a slightly different notation by replacing the symbols <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34585-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528666" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.405em, 1000em, 2.631em, -0.593em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-528667"><span class="msubsup" id="MathJax-Span-528668"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528669" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-528670" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.151em; vertical-align: -0.336em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34585">f_l</script> with the symbols <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34586-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528671" style="width: 1.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.637em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.56em, -0.434em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-528672"><span class="msubsup" id="MathJax-Span-528673"><span style="display: inline-block; position: relative; width: 1.613em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528674"><span class="mrow" id="MathJax-Span-528675"><span class="mi" id="MathJax-Span-528676" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="texatom" id="MathJax-Span-528677"><span class="mrow" id="MathJax-Span-528678"><span class="mi" id="MathJax-Span-528679" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528680" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528681" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.828em; vertical-align: -0.256em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34586">\bx_{l+1}</script>. If you do so, do you notice any formal cancelation?</li>
  <li>The formula only includes the derivative symbols. However, these derivatives must be computed at a well defined point. What is this point?</li>
  </ul>
</blockquote>

<p>To apply the chain rule we must be able to compute, for each function <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34587-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528682" style="width: 0.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.298em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.648em, 1000em, 2.64em, -0.405em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528683"><span class="mi" id="MathJax-Span-528684" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.888em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34587">l</script>, its derivative with respect to the parameters <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34588-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528685" style="width: 1.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.539em, -0.423em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-528686"><span class="msubsup" id="MathJax-Span-528687"><span style="display: inline-block; position: relative; width: 1.017em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528688"><span class="mrow" id="MathJax-Span-528689"><span class="mi" id="MathJax-Span-528690" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mi" id="MathJax-Span-528691" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.804em; vertical-align: -0.232em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34588">\bw_l</script> as well as its input <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34589-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528692" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.622em, 1000em, 2.539em, -0.434em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-528693"><span class="msubsup" id="MathJax-Span-528694"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528695"><span class="mrow" id="MathJax-Span-528696"><span class="mi" id="MathJax-Span-528697" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="mi" id="MathJax-Span-528698" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.804em; vertical-align: -0.232em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34589">\bx_l</script>. While this could be done naively, a problem is the very high dimensionality of the matrices involved in this calculation as these are <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34590-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528699" style="width: 7.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.994em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.552em, 1000em, 2.654em, -0.464em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528700"><span class="msup" id="MathJax-Span-528701"><span style="display: inline-block; position: relative; width: 1.278em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.464em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528702" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.662em; left: 0.955em;"><span class="mo" id="MathJax-Span-528703" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="msup" id="MathJax-Span-528704"><span style="display: inline-block; position: relative; width: 1.135em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.644em, -0.466em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528705" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.662em; left: 0.812em;"><span class="mo" id="MathJax-Span-528706" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="msup" id="MathJax-Span-528707"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.439em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528708" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.662em; left: 0.811em;"><span class="mo" id="MathJax-Span-528709" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528710" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-528711" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-528712" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-528713" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.084em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34590">M'N'K' \times MNK</script> arrays. We will now introduce a “trick” that allows reducing this to working with <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34591-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528714" style="width: 2.625em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.331em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.644em, -0.464em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528715"><span class="mi" id="MathJax-Span-528716" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-528717" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-528718" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.859em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34591">MNK</script> numbers only and which will yield to the <em>backpropagation algorithm</em>. </p>

<p>The key observation is that we ear not after <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34592-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528719" style="width: 5.458em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.861em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.519em, 1000em, 2.955em, -0.406em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528720"><span class="mi" id="MathJax-Span-528721" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528722" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="mo" id="MathJax-Span-528723"></span><span class="msubsup" id="MathJax-Span-528724" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528725" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-528726" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="texatom" id="MathJax-Span-528727"><span class="mrow" id="MathJax-Span-528728"><span class="mo" id="MathJax-Span-528729" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-528730" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528731"><span style="display: inline-block; position: relative; width: 1.315em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528732"><span class="mrow" id="MathJax-Span-528733"><span class="mi" id="MathJax-Span-528734" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.665em, 1000em, 2.431em, -0.412em); top: -2.626em; left: 0.744em;"><span class="mi" id="MathJax-Span-528735" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.65em, 1000em, 2.438em, -0.417em); top: -1.963em; left: 0.744em;"><span class="mi" id="MathJax-Span-528736" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.387em; vertical-align: -0.421em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34592">\partial \vc f_l / \partial \bw_l^\top</script> but after <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34593-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528737" style="width: 3.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.976em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.519em, 1000em, 2.955em, -0.406em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528738"><span class="mi" id="MathJax-Span-528739" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528740" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="texatom" id="MathJax-Span-528741"><span class="mrow" id="MathJax-Span-528742"><span class="mo" id="MathJax-Span-528743" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-528744" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528745"><span style="display: inline-block; position: relative; width: 1.315em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528746"><span class="mrow" id="MathJax-Span-528747"><span class="mi" id="MathJax-Span-528748" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.665em, 1000em, 2.431em, -0.412em); top: -2.626em; left: 0.744em;"><span class="mi" id="MathJax-Span-528749" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.65em, 1000em, 2.438em, -0.417em); top: -1.963em; left: 0.744em;"><span class="mi" id="MathJax-Span-528750" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.387em; vertical-align: -0.421em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34593">\partial f/ \partial\bw_l^\top</script>: <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34594-Frame" style=""><nobr><span class="math" id="MathJax-Span-528751" style="width: 12.292em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.962em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(0.929em, 1000em, 3.753em, -0.446em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528752"><span class="mfrac" id="MathJax-Span-528753"><span style="display: inline-block; position: relative; width: 1.906em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.406em); top: -3.157em; left: 50%; margin-left: -0.446em;"><span class="mrow" id="MathJax-Span-528754"><span class="mi" id="MathJax-Span-528755" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528756" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.519em, 1000em, 2.955em, -0.406em); top: -1.704em; left: 50%; margin-left: -0.893em;"><span class="mrow" id="MathJax-Span-528757"><span class="mi" id="MathJax-Span-528758" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528759"><span style="display: inline-block; position: relative; width: 1.315em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528760"><span class="mrow" id="MathJax-Span-528761"><span class="mi" id="MathJax-Span-528762" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.665em, 1000em, 2.431em, -0.412em); top: -2.626em; left: 0.744em;"><span class="mi" id="MathJax-Span-528763" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.65em, 1000em, 2.438em, -0.417em); top: -1.963em; left: 0.744em;"><span class="mi" id="MathJax-Span-528764" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 1.906em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-528765" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-528766" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.939em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.663em, 1000em, 2.899em, -0.406em); top: -3.215em; left: 50%; margin-left: -1.042em;"><span class="mrow" id="MathJax-Span-528767"><span class="mi" id="MathJax-Span-528768" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528769"><span style="display: inline-block; position: relative; width: 1.613em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.438em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528770" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.496em;"><span class="texatom" id="MathJax-Span-528771"><span class="mrow" id="MathJax-Span-528772"><span class="mi" id="MathJax-Span-528773" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528774" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528775" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.519em, 1000em, 2.976em, -0.406em); top: -1.704em; left: 50%; margin-left: -1.91em;"><span class="mrow" id="MathJax-Span-528776"><span class="mi" id="MathJax-Span-528777" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528778" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="msubsup" id="MathJax-Span-528779" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.613em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528780"><span class="mrow" id="MathJax-Span-528781"><span class="mi" id="MathJax-Span-528782" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.665em, 1000em, 2.431em, -0.412em); top: -2.626em; left: 0.496em;"><span class="mi" id="MathJax-Span-528783" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.65em, 1000em, 2.46em, -0.417em); top: -1.963em; left: 0.496em;"><span class="texatom" id="MathJax-Span-528784"><span class="mrow" id="MathJax-Span-528785"><span class="mi" id="MathJax-Span-528786" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528787" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528788" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 3.939em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-528789" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.898em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.879em, -0.406em); top: -3.194em; left: 50%; margin-left: -1.389em;"><span class="mrow" id="MathJax-Span-528790"><span class="mi" id="MathJax-Span-528791" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528792" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="mo" id="MathJax-Span-528793"></span><span class="msubsup" id="MathJax-Span-528794" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528795" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-528796" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.519em, 1000em, 2.955em, -0.406em); top: -1.704em; left: 50%; margin-left: -0.893em;"><span class="mrow" id="MathJax-Span-528797"><span class="mi" id="MathJax-Span-528798" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528799"><span style="display: inline-block; position: relative; width: 1.315em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528800"><span class="mrow" id="MathJax-Span-528801"><span class="mi" id="MathJax-Span-528802" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.665em, 1000em, 2.431em, -0.412em); top: -2.626em; left: 0.744em;"><span class="mi" id="MathJax-Span-528803" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span><span style="position: absolute; clip: rect(1.65em, 1000em, 2.438em, -0.417em); top: -1.963em; left: 0.744em;"><span class="mi" id="MathJax-Span-528804" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.19em, -0.446em); top: -1.262em; left: 0em;"><span style="border-left-width: 2.898em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.941em; vertical-align: -1.315em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-34594">
 \frac{\partial f}{\partial\bw_l^\top}
 =
 \frac{\partial g_{l+1}}{\partial \vc \bx_{l+1}^\top}
  \frac{\partial \vc f_l}{\partial \bw_l^\top}
</script> <br>
where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34595-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528805" style="width: 8.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.738em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.9em, -0.438em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528806"><span class="msubsup" id="MathJax-Span-528807"><span style="display: inline-block; position: relative; width: 1.613em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.438em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528808" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.496em;"><span class="texatom" id="MathJax-Span-528809"><span class="mrow" id="MathJax-Span-528810"><span class="mi" id="MathJax-Span-528811" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528812" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528813" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528814" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-528815" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528816" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-528817" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528818" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∘</span><span class="mo" id="MathJax-Span-528819" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">⋯</span><span class="mo" id="MathJax-Span-528820" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∘</span><span class="msubsup" id="MathJax-Span-528821" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.417em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528822" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="texatom" id="MathJax-Span-528823"><span class="mrow" id="MathJax-Span-528824"><span class="mi" id="MathJax-Span-528825" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528826" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528827" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.174em; vertical-align: -0.359em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34595">g_{l+1} = f_L \circ \dots \circ f_{l+1}</script> is the “tail” of the CNN.</p>

<blockquote>
  <p><strong>Question:</strong> Explain why the diemnsions of the vectors <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34596-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528828" style="width: 6.958em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.256em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.676em, 1000em, 2.923em, -0.41em); top: -2.503em; left: 0em;"><span class="mrow" id="MathJax-Span-528829"><span class="mi" id="MathJax-Span-528830" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528831"><span style="display: inline-block; position: relative; width: 1.627em; height: 0px;"><span style="position: absolute; clip: rect(1.911em, 1000em, 2.859em, -0.442em); top: -2.503em; left: 0em;"><span class="mi" id="MathJax-Span-528832" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.061em; left: 0.501em;"><span class="texatom" id="MathJax-Span-528833"><span class="mrow" id="MathJax-Span-528834"><span class="mi" id="MathJax-Span-528835" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528836" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528837" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span><span class="texatom" id="MathJax-Span-528838"><span class="mrow" id="MathJax-Span-528839"><span class="mo" id="MathJax-Span-528840" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-528841" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528842" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">vec</span><span class="msubsup" id="MathJax-Span-528843" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.627em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.653em, -0.438em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-528844"><span class="mrow" id="MathJax-Span-528845"><span class="mi" id="MathJax-Span-528846" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.501em;"><span class="texatom" id="MathJax-Span-528847"><span class="mrow" id="MathJax-Span-528848"><span class="mi" id="MathJax-Span-528849" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528850" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528851" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.162em; vertical-align: -0.356em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34596">\partial g_{l+1}/\partial \vc \bx_{l+1}</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34597-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528852" style="width: 3.014em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.703em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.674em, 1000em, 2.86em, -0.41em); top: -2.503em; left: 0em;"><span class="mrow" id="MathJax-Span-528853"><span class="mi" id="MathJax-Span-528854" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-528855" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="texatom" id="MathJax-Span-528856"><span class="mrow" id="MathJax-Span-528857"><span class="mo" id="MathJax-Span-528858" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-528859" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528860"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.667em, -0.427em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-528861"><span class="mrow" id="MathJax-Span-528862"><span class="mi" id="MathJax-Span-528863" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.751em;"><span class="texatom" id="MathJax-Span-528864"><span class="mrow" id="MathJax-Span-528865"><span class="mi" id="MathJax-Span-528866" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.093em; vertical-align: -0.285em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34597">\partial f/\partial \bw_{l}</script> equals the number of elements in <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34598-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528867" style="width: 1.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.641em, 1000em, 2.581em, -0.438em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-528868"><span class="msubsup" id="MathJax-Span-528869"><span style="display: inline-block; position: relative; width: 1.627em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.653em, -0.438em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-528870"><span class="mrow" id="MathJax-Span-528871"><span class="mi" id="MathJax-Span-528872" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.501em;"><span class="texatom" id="MathJax-Span-528873"><span class="mrow" id="MathJax-Span-528874"><span class="mi" id="MathJax-Span-528875" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528876" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528877" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.252em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.822em; vertical-align: -0.254em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34598">\bx_{l+1}</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34599-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528878" style="width: 1.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.051em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.641em, 1000em, 2.56em, -0.427em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-528879"><span class="msubsup" id="MathJax-Span-528880"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.667em, -0.427em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-528881"><span class="mrow" id="MathJax-Span-528882"><span class="mi" id="MathJax-Span-528883" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.751em;"><span class="mi" id="MathJax-Span-528884" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.252em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.798em; vertical-align: -0.231em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34599">\bw_l</script> respectively. Hence, in particular, the symbol <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34600-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528885" style="width: 5.014em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.505em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.676em, 1000em, 2.923em, -0.41em); top: -2.503em; left: 0em;"><span class="mrow" id="MathJax-Span-528886"><span class="mi" id="MathJax-Span-528887" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528888"><span style="display: inline-block; position: relative; width: 1.627em; height: 0px;"><span style="position: absolute; clip: rect(1.911em, 1000em, 2.859em, -0.442em); top: -2.503em; left: 0em;"><span class="mi" id="MathJax-Span-528889" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.061em; left: 0.501em;"><span class="texatom" id="MathJax-Span-528890"><span class="mrow" id="MathJax-Span-528891"><span class="mi" id="MathJax-Span-528892" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528893" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528894" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span><span class="texatom" id="MathJax-Span-528895"><span class="mrow" id="MathJax-Span-528896"><span class="mo" id="MathJax-Span-528897" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-528898" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-528899"><span style="display: inline-block; position: relative; width: 1.627em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.653em, -0.438em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-528900"><span class="mrow" id="MathJax-Span-528901"><span class="mi" id="MathJax-Span-528902" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.501em;"><span class="texatom" id="MathJax-Span-528903"><span class="mrow" id="MathJax-Span-528904"><span class="mi" id="MathJax-Span-528905" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528906" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528907" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.162em; vertical-align: -0.356em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34600">\partial g_{l+1}/\partial \bx_{l+1}</script> (without vectorisation) denotes an array with the same size of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34601-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528908" style="width: 1.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.641em, 1000em, 2.581em, -0.438em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-528909"><span class="msubsup" id="MathJax-Span-528910"><span style="display: inline-block; position: relative; width: 1.627em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.653em, -0.438em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-528911"><span class="mrow" id="MathJax-Span-528912"><span class="mi" id="MathJax-Span-528913" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.501em;"><span class="texatom" id="MathJax-Span-528914"><span class="mrow" id="MathJax-Span-528915"><span class="mi" id="MathJax-Span-528916" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528917" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528918" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.252em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.822em; vertical-align: -0.254em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34601">\bx_{l+1}</script>.</p>
  
  <p><strong>Hint:</strong> recall that the last layer is the loss.</p>
</blockquote>

<p>Hence the algorithm can focus on computing the derivatives of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34602-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528919" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.642em, 1000em, 2.63em, -0.438em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-528920"><span class="msubsup" id="MathJax-Span-528921"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.438em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528922" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.496em;"><span class="texatom" id="MathJax-Span-528923"><span class="mrow" id="MathJax-Span-528924"><span class="mi" id="MathJax-Span-528925" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.884em; vertical-align: -0.335em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34602">g_{l}</script> instead of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34603-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528926" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.405em, 1000em, 2.631em, -0.593em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-528927"><span class="msubsup" id="MathJax-Span-528928"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528929" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="texatom" id="MathJax-Span-528930"><span class="mrow" id="MathJax-Span-528931"><span class="mi" id="MathJax-Span-528932" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.151em; vertical-align: -0.336em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34603">f_{l}</script> which are far lower-dimensional. To see how this can be done iteratively, decompose <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34604-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-528933" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.642em, 1000em, 2.63em, -0.438em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-528934"><span class="msubsup" id="MathJax-Span-528935"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.438em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528936" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.496em;"><span class="mi" id="MathJax-Span-528937" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.884em; vertical-align: -0.335em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34604">g_l</script> as: <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34605-Frame" style=""><nobr><span class="math" id="MathJax-Span-528938" style="width: 17.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.526em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.344em, 1000em, 5.227em, -0.434em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-528939"><span class="msubsup" id="MathJax-Span-528940"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528941"><span class="mrow" id="MathJax-Span-528942"><span class="mi" id="MathJax-Span-528943" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="texatom" id="MathJax-Span-528944"><span class="mrow" id="MathJax-Span-528945"><span class="mi" id="MathJax-Span-528946" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528947" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">⟶</span><span class="munder" id="MathJax-Span-528948" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(2.882em, 1000em, 4.726em, -0.446em); top: -4.018em; left: 0em;"><span class="menclose" id="MathJax-Span-528949"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span id="MathJax-frame-528949" style="border: 0.084em solid; display: inline-block; overflow: hidden; width: 1.024em; height: 1.378em; vertical-align: -0.084em; position: absolute; top: -0.987em; left: 0em;"></span><span style="position: absolute; clip: rect(3.191em, 1000em, 4.417em, -0.593em); top: -4.018em; left: 0.309em;"><span class="mrow" id="MathJax-Span-528950"><span class="texatom" id="MathJax-Span-528951"><span class="mrow" id="MathJax-Span-528952"><span class="mstyle" id="MathJax-Span-528953"><span class="mrow" id="MathJax-Span-528954"><span class="texatom" id="MathJax-Span-528955"><span class="mrow" id="MathJax-Span-528956"><span class="msubsup" id="MathJax-Span-528957"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528958" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.039em; left: 0.3em;"><span class="mi" id="MathJax-Span-528959" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span><span style="position: absolute; clip: rect(3.207em, 1000em, 5.355em, -0.423em); top: -2.609em; left: 0.088em;"><span class="mstyle" id="MathJax-Span-528960"><span class="mrow" id="MathJax-Span-528961"><span class="munder" id="MathJax-Span-528962"><span style="display: inline-block; position: relative; width: 1.017em; height: 0px;"><span style="position: absolute; clip: rect(1.669em, 1000em, 2.785em, -0.386em); top: -2.48em; left: 0.236em;"><span class="mo" id="MathJax-Span-528963" style="font-family: STIXGeneral-Regular;">↑</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(3.408em, 1000em, 4.424em, -0.423em); top: -3.187em; left: 0em;"><span class="mstyle" id="MathJax-Span-528964"><span class="mrow" id="MathJax-Span-528965"><span class="msubsup" id="MathJax-Span-528966"><span style="display: inline-block; position: relative; width: 1.017em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528967"><span class="mrow" id="MathJax-Span-528968"><span class="mi" id="MathJax-Span-528969" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="mi" id="MathJax-Span-528970" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span></span></span><span class="mo" id="MathJax-Span-528971" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">⟶</span><span class="msubsup" id="MathJax-Span-528972" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.613em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528973"><span class="mrow" id="MathJax-Span-528974"><span class="mi" id="MathJax-Span-528975" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="texatom" id="MathJax-Span-528976"><span class="mrow" id="MathJax-Span-528977"><span class="mi" id="MathJax-Span-528978" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528979" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528980" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="mo" id="MathJax-Span-528981" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">⟶</span><span class="menclose" id="MathJax-Span-528982" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.231em; height: 0px;"><span id="MathJax-frame-528982" style="border: 0.084em solid; display: inline-block; overflow: hidden; width: 2.063em; height: 1.161em; vertical-align: -0.084em; position: absolute; top: -0.75em; left: 0em;"></span><span style="position: absolute; clip: rect(3.428em, 1000em, 4.437em, -0.438em); top: -4.018em; left: 0.309em;"><span class="mrow" id="MathJax-Span-528983"><span class="texatom" id="MathJax-Span-528984"><span class="mrow" id="MathJax-Span-528985"><span class="mstyle" id="MathJax-Span-528986"><span class="mrow" id="MathJax-Span-528987"><span class="texatom" id="MathJax-Span-528988"><span class="mrow" id="MathJax-Span-528989"><span class="msubsup" id="MathJax-Span-528990"><span style="display: inline-block; position: relative; width: 1.613em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.438em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-528991" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.496em;"><span class="texatom" id="MathJax-Span-528992"><span class="mrow" id="MathJax-Span-528993"><span class="mi" id="MathJax-Span-528994" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-528995" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-528996" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span></span></span><span class="mo" id="MathJax-Span-528997" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">⟶</span><span class="msubsup" id="MathJax-Span-528998" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-528999"><span class="mrow" id="MathJax-Span-529000"><span class="mi" id="MathJax-Span-529001" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="texatom" id="MathJax-Span-529002"><span class="mrow" id="MathJax-Span-529003"><span class="mi" id="MathJax-Span-529004" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.126em; vertical-align: -2.965em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-34605">
 \bx_{l}
 \longrightarrow 
 \underset{\displaystyle\underset{\displaystyle\bw_l}{\uparrow}}{\boxed{f_l}} 
 \longrightarrow
 \bx_{l+1}  
 \longrightarrow 
 \boxed{g_{l+1}}
 \longrightarrow
 \bx_{L}
</script> <br>
Then the key of the iteration is obtaining the derivatives for layer <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34606-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529005" style="width: 0.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.298em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.648em, 1000em, 2.64em, -0.405em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529006"><span class="mi" id="MathJax-Span-529007" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.888em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34606">l</script> given the ones for layer <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34607-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529008" style="width: 2.236em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.648em, 1000em, 2.67em, -0.405em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529009"><span class="mi" id="MathJax-Span-529010" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-529011" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-529012" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.922em; vertical-align: -0.101em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34607">l+1</script>:</p>

<ul>
<li>Input: <br>
<ul><li>the derivative <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34608-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529013" style="width: 5.014em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.464em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.655em, 1000em, 2.899em, -0.406em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529014"><span class="mi" id="MathJax-Span-529015" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-529016"><span style="display: inline-block; position: relative; width: 1.613em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.438em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-529017" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.496em;"><span class="texatom" id="MathJax-Span-529018"><span class="mrow" id="MathJax-Span-529019"><span class="mi" id="MathJax-Span-529020" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-529021" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-529022" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="texatom" id="MathJax-Span-529023"><span class="mrow" id="MathJax-Span-529024"><span class="mo" id="MathJax-Span-529025" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-529026" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-529027"><span style="display: inline-block; position: relative; width: 1.613em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-529028"><span class="mrow" id="MathJax-Span-529029"><span class="mi" id="MathJax-Span-529030" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="texatom" id="MathJax-Span-529031"><span class="mrow" id="MathJax-Span-529032"><span class="mi" id="MathJax-Span-529033" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-529034" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-529035" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.171em; vertical-align: -0.358em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34608">\partial g_{l+1}/\partial \bx_{l+1}</script>.</li></ul></li>
<li>Output: <br>
<ul><li>the derivative <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34609-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529036" style="width: 3.125em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.778em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.655em, 1000em, 2.878em, -0.406em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529037"><span class="mi" id="MathJax-Span-529038" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-529039"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.438em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-529040" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.496em;"><span class="texatom" id="MathJax-Span-529041"><span class="mrow" id="MathJax-Span-529042"><span class="mi" id="MathJax-Span-529043" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="texatom" id="MathJax-Span-529044"><span class="mrow" id="MathJax-Span-529045"><span class="mo" id="MathJax-Span-529046" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-529047" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-529048"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-529049"><span class="mrow" id="MathJax-Span-529050"><span class="mi" id="MathJax-Span-529051" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.496em;"><span class="texatom" id="MathJax-Span-529052"><span class="mrow" id="MathJax-Span-529053"><span class="mi" id="MathJax-Span-529054" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.147em; vertical-align: -0.335em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34609">\partial g_{l}/\partial \bx_{l}</script></li>
<li>the derivative  <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34610-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529055" style="width: 3.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.026em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.655em, 1000em, 2.878em, -0.406em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529056"><span class="mi" id="MathJax-Span-529057" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-529058"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.438em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-529059" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.04em; left: 0.496em;"><span class="texatom" id="MathJax-Span-529060"><span class="mrow" id="MathJax-Span-529061"><span class="mi" id="MathJax-Span-529062" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span><span class="texatom" id="MathJax-Span-529063"><span class="mrow" id="MathJax-Span-529064"><span class="mo" id="MathJax-Span-529065" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-529066" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-529067"><span style="display: inline-block; position: relative; width: 1.017em; height: 0px;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="texatom" id="MathJax-Span-529068"><span class="mrow" id="MathJax-Span-529069"><span class="mi" id="MathJax-Span-529070" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.744em;"><span class="texatom" id="MathJax-Span-529071"><span class="mrow" id="MathJax-Span-529072"><span class="mi" id="MathJax-Span-529073" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.147em; vertical-align: -0.335em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34610">\partial g_{l}/\partial \bw_{l}</script></li></ul></li>
</ul>

<blockquote>
  <p><strong>Question:</strong> Suppose that <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34611-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529074" style="width: 0.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.424em, 1000em, 2.653em, -0.597em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-529075"><span class="msubsup" id="MathJax-Span-529076"><span style="display: inline-block; position: relative; width: 0.58em; height: 0px;"><span style="position: absolute; clip: rect(1.674em, 1000em, 2.86em, -0.597em); top: -2.503em; left: 0em;"><span class="mi" id="MathJax-Span-529077" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.06em; left: 0.304em;"><span class="mi" id="MathJax-Span-529078" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.252em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.141em; vertical-align: -0.333em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34611">f_l</script> is the function <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34612-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529079" style="width: 4.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.354em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.684em, 1000em, 2.832em, -0.438em); top: -2.503em; left: 0em;"><span class="mrow" id="MathJax-Span-529080"><span class="msubsup" id="MathJax-Span-529081"><span style="display: inline-block; position: relative; width: 1.627em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.653em, -0.438em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-529082"><span class="mrow" id="MathJax-Span-529083"><span class="mi" id="MathJax-Span-529084" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.501em;"><span class="texatom" id="MathJax-Span-529085"><span class="mrow" id="MathJax-Span-529086"><span class="mi" id="MathJax-Span-529087" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-529088" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-529089" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span><span class="mo" id="MathJax-Span-529090" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-529091" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">A</span><span class="msubsup" id="MathJax-Span-529092"><span style="display: inline-block; position: relative; width: 0.776em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.653em, -0.438em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-529093"><span class="mrow" id="MathJax-Span-529094"><span class="mi" id="MathJax-Span-529095" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.501em;"><span class="texatom" id="MathJax-Span-529096"><span class="mrow" id="MathJax-Span-529097"><span class="mi" id="MathJax-Span-529098" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.051em; vertical-align: -0.254em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34612">\bx_{l+1} = A \bx_{l}</script> where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34613-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529099" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.801em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.641em, 1000em, 2.56em, -0.438em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-529100"><span class="msubsup" id="MathJax-Span-529101"><span style="display: inline-block; position: relative; width: 0.776em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.653em, -0.438em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-529102"><span class="mrow" id="MathJax-Span-529103"><span class="mi" id="MathJax-Span-529104" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.501em;"><span class="texatom" id="MathJax-Span-529105"><span class="mrow" id="MathJax-Span-529106"><span class="mi" id="MathJax-Span-529107" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.252em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.798em; vertical-align: -0.231em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34613">\bx_{l}</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34614-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529108" style="width: 1.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.641em, 1000em, 2.581em, -0.438em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-529109"><span class="msubsup" id="MathJax-Span-529110"><span style="display: inline-block; position: relative; width: 1.627em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.653em, -0.438em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-529111"><span class="mrow" id="MathJax-Span-529112"><span class="mi" id="MathJax-Span-529113" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.501em;"><span class="texatom" id="MathJax-Span-529114"><span class="mrow" id="MathJax-Span-529115"><span class="mi" id="MathJax-Span-529116" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-529117" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-529118" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.252em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.822em; vertical-align: -0.254em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34614">\bx_{l+1}</script> are column vectors. Suppose that <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34615-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529119" style="width: 7.125em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.406em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.676em, 1000em, 2.923em, -0.458em); top: -2.503em; left: 0em;"><span class="mrow" id="MathJax-Span-529120"><span class="mi" id="MathJax-Span-529121" style="font-family: STIXGeneral-Italic;">B</span><span class="mo" id="MathJax-Span-529122" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-529123" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∂</span><span class="msubsup" id="MathJax-Span-529124"><span style="display: inline-block; position: relative; width: 1.627em; height: 0px;"><span style="position: absolute; clip: rect(1.911em, 1000em, 2.859em, -0.442em); top: -2.503em; left: 0em;"><span class="mi" id="MathJax-Span-529125" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.061em; left: 0.501em;"><span class="texatom" id="MathJax-Span-529126"><span class="mrow" id="MathJax-Span-529127"><span class="mi" id="MathJax-Span-529128" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-529129" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-529130" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span><span class="texatom" id="MathJax-Span-529131"><span class="mrow" id="MathJax-Span-529132"><span class="mo" id="MathJax-Span-529133" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-529134" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-529135"><span style="display: inline-block; position: relative; width: 1.627em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.653em, -0.438em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-529136"><span class="mrow" id="MathJax-Span-529137"><span class="mi" id="MathJax-Span-529138" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.501em;"><span class="texatom" id="MathJax-Span-529139"><span class="mrow" id="MathJax-Span-529140"><span class="mi" id="MathJax-Span-529141" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-529142" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-529143" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.162em; vertical-align: -0.356em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34615">B = \partial g_{l+1}/\partial \bx_{l+1} </script> is given. Derive an expression for <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34616-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529144" style="width: 5.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.805em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.676em, 1000em, 2.902em, -0.384em); top: -2.503em; left: 0em;"><span class="mrow" id="MathJax-Span-529145"><span class="mi" id="MathJax-Span-529146" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.022em;"></span></span><span class="mo" id="MathJax-Span-529147" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-529148" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∂</span><span class="msubsup" id="MathJax-Span-529149"><span style="display: inline-block; position: relative; width: 0.776em; height: 0px;"><span style="position: absolute; clip: rect(1.911em, 1000em, 2.859em, -0.442em); top: -2.503em; left: 0em;"><span class="mi" id="MathJax-Span-529150" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.061em; left: 0.501em;"><span class="texatom" id="MathJax-Span-529151"><span class="mrow" id="MathJax-Span-529152"><span class="mi" id="MathJax-Span-529153" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span><span class="texatom" id="MathJax-Span-529154"><span class="mrow" id="MathJax-Span-529155"><span class="mo" id="MathJax-Span-529156" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-529157" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-529158"><span style="display: inline-block; position: relative; width: 0.776em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.653em, -0.438em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-529159"><span class="mrow" id="MathJax-Span-529160"><span class="mi" id="MathJax-Span-529161" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.501em;"><span class="texatom" id="MathJax-Span-529162"><span class="mrow" id="MathJax-Span-529163"><span class="mi" id="MathJax-Span-529164" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.138em; vertical-align: -0.332em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34616">C = \partial g_{l}/\partial \bx_{l}</script> and an expression for <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34617-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529165" style="width: 5.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.105em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.676em, 1000em, 2.902em, -0.458em); top: -2.503em; left: 0em;"><span class="mrow" id="MathJax-Span-529166"><span class="mi" id="MathJax-Span-529167" style="font-family: STIXGeneral-Italic;">D</span><span class="mo" id="MathJax-Span-529168" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-529169" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∂</span><span class="msubsup" id="MathJax-Span-529170"><span style="display: inline-block; position: relative; width: 0.776em; height: 0px;"><span style="position: absolute; clip: rect(1.911em, 1000em, 2.859em, -0.442em); top: -2.503em; left: 0em;"><span class="mi" id="MathJax-Span-529171" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.061em; left: 0.501em;"><span class="texatom" id="MathJax-Span-529172"><span class="mrow" id="MathJax-Span-529173"><span class="mi" id="MathJax-Span-529174" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span><span class="texatom" id="MathJax-Span-529175"><span class="mrow" id="MathJax-Span-529176"><span class="mo" id="MathJax-Span-529177" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-529178" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-529179"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(1.891em, 1000em, 2.667em, -0.427em); top: -2.503em; left: 0em;"><span class="texatom" id="MathJax-Span-529180"><span class="mrow" id="MathJax-Span-529181"><span class="mi" id="MathJax-Span-529182" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span><span style="position: absolute; top: -2.152em; left: 0.751em;"><span class="texatom" id="MathJax-Span-529183"><span class="mrow" id="MathJax-Span-529184"><span class="mi" id="MathJax-Span-529185" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.138em; vertical-align: -0.332em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34617">D =  \partial g_{l}/\partial \bw_{l}</script>.</p>
</blockquote>

<h3 id="part-21-putting-it-to-the-practice">Part 2.1: Putting it to the practice</h3>

<p>A key feature of MatConvNet and similar neural-netowrk packages is the ability to support back-propagation. In order to do so, lets focus on a single computational block <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34626-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529226" style="width: 0.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529227"><span class="mi" id="MathJax-Span-529228" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.102em; vertical-align: -0.287em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34626">f</script>, followed by a function <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34627-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529229" style="width: 0.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.496em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.438em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529230"><span class="mi" id="MathJax-Span-529231" style="font-family: STIXGeneral-Italic;">g</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.286em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34627">g</script>: <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34628-Frame" style=""><nobr><span class="math" id="MathJax-Span-529232" style="width: 13.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.351em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.344em, 1000em, 5.04em, -0.434em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529233"><span class="texatom" id="MathJax-Span-529234"><span class="mrow" id="MathJax-Span-529235"><span class="mi" id="MathJax-Span-529236" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-529237" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">⟶</span><span class="munder" id="MathJax-Span-529238" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(2.882em, 1000em, 4.683em, -0.446em); top: -4.018em; left: 0em;"><span class="menclose" id="MathJax-Span-529239"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span id="MathJax-frame-529239" style="border: 0.084em solid; display: inline-block; overflow: hidden; width: 0.896em; height: 1.335em; vertical-align: -0.084em; position: absolute; top: -0.987em; left: 0em;"></span><span style="position: absolute; clip: rect(1.653em, 1000em, 2.836em, -0.593em); top: -2.48em; left: 0.309em;"><span class="mrow" id="MathJax-Span-529240"><span class="texatom" id="MathJax-Span-529241"><span class="mrow" id="MathJax-Span-529242"><span class="mstyle" id="MathJax-Span-529243"><span class="mrow" id="MathJax-Span-529244"><span class="texatom" id="MathJax-Span-529245"><span class="mrow" id="MathJax-Span-529246"><span class="mi" id="MathJax-Span-529247" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span><span style="position: absolute; clip: rect(3.207em, 1000em, 5.212em, -0.423em); top: -2.652em; left: 0.161em;"><span class="mstyle" id="MathJax-Span-529248"><span class="mrow" id="MathJax-Span-529249"><span class="munder" id="MathJax-Span-529250"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px;"><span style="position: absolute; clip: rect(1.669em, 1000em, 2.785em, -0.386em); top: -2.48em; left: 0.099em;"><span class="mo" id="MathJax-Span-529251" style="font-family: STIXGeneral-Regular;">↑</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.87em, 1000em, 2.743em, -0.423em); top: -1.649em; left: 0em;"><span class="mstyle" id="MathJax-Span-529252"><span class="mrow" id="MathJax-Span-529253"><span class="texatom" id="MathJax-Span-529254"><span class="mrow" id="MathJax-Span-529255"><span class="mi" id="MathJax-Span-529256" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.018em;"></span></span></span></span><span class="mo" id="MathJax-Span-529257" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">⟶</span><span class="texatom" id="MathJax-Span-529258" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-529259"><span class="mi" id="MathJax-Span-529260" style="font-family: STIXGeneral; font-weight: bold;">y</span></span></span><span class="mo" id="MathJax-Span-529261" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">⟶</span><span class="menclose" id="MathJax-Span-529262" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.115em; height: 0px;"><span id="MathJax-frame-529262" style="border: 0.084em solid; display: inline-block; overflow: hidden; width: 0.946em; height: 1.097em; vertical-align: -0.084em; position: absolute; top: -0.75em; left: 0em;"></span><span style="position: absolute; clip: rect(1.89em, 1000em, 2.835em, -0.438em); top: -2.48em; left: 0.309em;"><span class="mrow" id="MathJax-Span-529263"><span class="texatom" id="MathJax-Span-529264"><span class="mrow" id="MathJax-Span-529265"><span class="mstyle" id="MathJax-Span-529266"><span class="mrow" id="MathJax-Span-529267"><span class="texatom" id="MathJax-Span-529268"><span class="mrow" id="MathJax-Span-529269"><span class="mi" id="MathJax-Span-529270" style="font-family: STIXGeneral-Italic;">g</span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span></span><span class="mo" id="MathJax-Span-529271" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">⟶</span><span class="mi" id="MathJax-Span-529272" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">z</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.917em; vertical-align: -2.756em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-34628">
 \bx
 \longrightarrow 
 \underset{\displaystyle\underset{\displaystyle\bw}{\uparrow}}{\boxed{f}} 
 \longrightarrow
 \by
 \longrightarrow 
 \boxed{g}
 \longrightarrow
 z
</script> <br>
where <em><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34629-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529273" style="width: 0.458em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.397em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.71em, -0.448em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529274"><span class="mi" id="MathJax-Span-529275" style="font-family: STIXGeneral-Italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.681em; vertical-align: -0.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34629">z</script> is assumed to be a scalar</em>. Then each computation block (for example <code>vl_nnconv</code> or <code>vl_nnpool</code>) can compute <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34630-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529276" style="width: 2.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.133em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.655em, 1000em, 2.71em, -0.406em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529277"><span class="mi" id="MathJax-Span-529278" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-529279" style="font-family: STIXGeneral-Italic;">z</span><span class="texatom" id="MathJax-Span-529280"><span class="mrow" id="MathJax-Span-529281"><span class="mo" id="MathJax-Span-529282" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-529283" style="font-family: STIXGeneral-Regular;">∂</span><span class="texatom" id="MathJax-Span-529284"><span class="mrow" id="MathJax-Span-529285"><span class="mi" id="MathJax-Span-529286" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.959em; vertical-align: -0.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34630">\partial z / \partial \bx</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34631-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529287" style="width: 2.625em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.331em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.655em, 1000em, 2.71em, -0.406em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529288"><span class="mi" id="MathJax-Span-529289" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-529290" style="font-family: STIXGeneral-Italic;">z</span><span class="texatom" id="MathJax-Span-529291"><span class="mrow" id="MathJax-Span-529292"><span class="mo" id="MathJax-Span-529293" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-529294" style="font-family: STIXGeneral-Regular;">∂</span><span class="texatom" id="MathJax-Span-529295"><span class="mrow" id="MathJax-Span-529296"><span class="mi" id="MathJax-Span-529297" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.959em; vertical-align: -0.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34631">\partial z / \partial \bw</script> given as input <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34632-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529298" style="width: 0.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.496em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.629em, -0.434em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529299"><span class="texatom" id="MathJax-Span-529300"><span class="mrow" id="MathJax-Span-529301"><span class="mi" id="MathJax-Span-529302" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34632">\bx</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34633-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529303" style="width: 2.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.133em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.655em, 1000em, 2.834em, -0.406em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529304"><span class="mi" id="MathJax-Span-529305" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-529306" style="font-family: STIXGeneral-Italic;">z</span><span class="texatom" id="MathJax-Span-529307"><span class="mrow" id="MathJax-Span-529308"><span class="mo" id="MathJax-Span-529309" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-529310" style="font-family: STIXGeneral-Regular;">∂</span><span class="texatom" id="MathJax-Span-529311"><span class="mrow" id="MathJax-Span-529312"><span class="mi" id="MathJax-Span-529313" style="font-family: STIXGeneral; font-weight: bold;">y</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.098em; vertical-align: -0.285em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34633">\partial z / \partial \by</script>. Let’s put this to the practice:</p>

<pre class="prettyprint"><code class="language-matlab hljs "><span class="hljs-comment">% Read an example image</span>
x = im2single(imread(<span class="hljs-string">'peppers.png'</span>)) ;

<span class="hljs-comment">% Create a bank of linear filters and apply them to the image</span>
w = <span class="hljs-built_in">randn</span>(<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">10</span>,<span class="hljs-string">'single'</span>) ;
y = vl_nnconv(x, w, <span class="hljs-matrix">[]</span>) ;

<span class="hljs-comment">% Create the derivative dz/dy</span>
dzdy = <span class="hljs-built_in">randn</span>(<span class="hljs-built_in">size</span>(y), <span class="hljs-string">'single'</span>) ;

<span class="hljs-comment">% Back-propagation</span>
<span class="hljs-matrix">[dzdx, dzdw]</span> = vl_nnconv(x, w, <span class="hljs-matrix">[]</span>, dzdy) ;</code></pre>

<blockquote>
  <p><strong>Task:</strong> Run the code above and check the dimensions of <code>dzdx</code> and <code>dzdy</code>. Does this matches your expectations?</p>
</blockquote>

<p>An advantage of this modular view is that new building blocks can be coded and added to the architecture in a simple manner. However, it is easy to make mistakes in the calculation of complex derivatives. Hence, it is a good idea to verify results numerically. Consider the following piece of code:</p>



<pre class="prettyprint"><code class="language-matlab hljs "><span class="hljs-comment">% Check the derivative numerically</span>
ex = <span class="hljs-built_in">randn</span>(<span class="hljs-built_in">size</span>(x), <span class="hljs-string">'single'</span>) ;
eta = <span class="hljs-number">0.0001</span> ;
xp = x + eta * ex  ;
yp = vl_nnconv(xp, w, <span class="hljs-matrix">[]</span>) ;

dzdx_empirical = sum(dzdy(:) .* (yp(:) - y(:)) / eta) ;
dzdx_computed = sum(dzdx(:) .* ex(:)) ;

fprintf(...
  <span class="hljs-string">'der: empirical: %f, computed: %f, error: %.2f %%\n'</span>, ...
  dzdx_empirical, dzdx_computed, ...
  <span class="hljs-built_in">abs</span>(<span class="hljs-number">1</span> - dzdx_empirical/dzdx_computed)*<span class="hljs-number">100</span>) ;</code></pre>

<blockquote>
  <p><strong>Questions:</strong></p>
  
  <ul>
  <li>What is the meaning f <code>ex</code> in the code above? </li>
  <li>What are the derivatives <code>dzdx_empirical</code> and <code>dzdx_comptued</code>?</li>
  </ul>
  
  <p><strong>Tasks:</strong></p>
  
  <ul>
  <li>Run the code and convince yourself that <code>vl_nnconv</code> derivatives is (probably) correct.</li>
  <li>Create a new version of this code to test the derivative calculation with respect to <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34651-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529399" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.87em, 1000em, 2.643em, -0.423em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-529400"><span class="texatom" id="MathJax-Span-529401"><span class="mrow" id="MathJax-Span-529402"><span class="mi" id="MathJax-Span-529403" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.643em; vertical-align: -0.071em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34651">\bw</script>.</li>
  </ul>
</blockquote>

<p>We are now ready to build our first elementary CNN, composed of jus two layers, and to compute its derivatives:</p>



<pre class="prettyprint"><code class="language-matlab hljs "><span class="hljs-comment">% Parameters of the CNN</span>
w1 = <span class="hljs-built_in">randn</span>(<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">10</span>,<span class="hljs-string">'single'</span>) ;
rho2 = <span class="hljs-number">10</span> ;

<span class="hljs-comment">% Run the CNN forward</span>
x1 = im2single(imread(<span class="hljs-string">'peppers.png'</span>)) ;
x2 = vl_nnconv(x1, w1, <span class="hljs-matrix">[]</span>) ;
x3 = vl_nnpool(x2, rho2) ;

<span class="hljs-comment">% Create the derivative dz/dx3</span>
dzdx3 = <span class="hljs-built_in">randn</span>(<span class="hljs-built_in">size</span>(x3), <span class="hljs-string">'single'</span>) ;

<span class="hljs-comment">% Run the CNN backward</span>
dzdx2 = vl_nnpool(x2, rho2, dzdx3) ;
<span class="hljs-matrix">[dzdx1, dzdw1]</span> = vl_nnconv(x1, w1, <span class="hljs-matrix">[]</span>, dzdx2) ;</code></pre>

<blockquote>
  <p><strong>Question:</strong> Note the last derivative is <code>dzdx3</code>. For the sake of the example, this derivative is initalized randomly. In a practical application, what would this derivative represent?</p>
</blockquote>

<p>We can now use the same technique as before to check that the derivative computed through back-propagation are correct.</p>

<pre class="prettyprint"><code class="language-matlab hljs "><span class="hljs-comment">% Check the derivative numerically</span>
ew1 = <span class="hljs-built_in">randn</span>(<span class="hljs-built_in">size</span>(w1), <span class="hljs-string">'single'</span>) ;
eta = <span class="hljs-number">0.0001</span> ;
w1p = w1 + eta * ew1  ;

x1p = x1 ;
x2p = vl_nnconv(x1p, w1p, <span class="hljs-matrix">[]</span>) ;
x3p = vl_nnpool(x2p, rho2) ;

dzdw1_empirical = sum(dzdx3(:) .* (x3p(:) - x3(:)) / eta) ;
dzdw1_computed = sum(dzdw1(:) .* ew1(:)) ;

fprintf(...
  <span class="hljs-string">'der: empirical: %f, computed: %f, error: %.2f %%\n'</span>, ...
  dzdw1_empirical, dzdw1_computed, ...
  <span class="hljs-built_in">abs</span>(<span class="hljs-number">1</span> - dzdw1_empirical/dzdw1_computed)*<span class="hljs-number">100</span>) ;</code></pre>

<h2 id="part-3-a-simple-cnn">Part 3: a simple CNN</h2>



<h2 id="part-4">Part 4:</h2>

<div class="footnotes"><hr><ol><li id="fn:lattice">A two-dimensional <em>lattice</em> is a discrete grid embedded in <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34709-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-529689" style="width: 1.236em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.091em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.225em, 1000em, 2.381em, -0.459em); top: -2.232em; left: 0em;"><span class="mrow" id="MathJax-Span-529690"><span class="msubsup" id="MathJax-Span-529691"><span style="display: inline-block; position: relative; width: 1.067em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.629em, -0.459em); top: -2.48em; left: 0em;"><span class="mi" id="MathJax-Span-529692" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.662em; left: 0.645em;"><span class="mn" id="MathJax-Span-529693" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.282em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.056em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34709">R^2</script>, similar for example to a checkerboard. <a href="#fnref:lattice" title="Return to article" class="reversefootnote">↩</a></li></ol></div></div></body>
</html>